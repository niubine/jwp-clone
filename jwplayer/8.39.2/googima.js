!function(){"use strict";const t="vast",e="googima",n="freewheel",r="playing",i="viewable",s="external",o=s,a="time",l="adBreakIgnored",u="__jwpseg__",d="instream",c="article",h={[[d]]:1,[["banner"]]:2,[[c]]:3,[["feed"]]:4,[["floating"]]:5,[["interstitial"]]:5,[["slider"]]:5},f="adError",p="adItem",g="adStarted",m="adSkipped",y="jw-flag-ads-vpaid",v="jw-flag-ads-vpaid-controls",_="-1",w="vmap",A="TYPE_API",b="TYPE_SCHEDULE",P="jw-flag-ads-googleima",k=(t,e)=>({begin:t._offSet,text:e,cueType:"ads",adId:t.adBreakId});class E{constructor(t,e,n,r){this.client=r,this.player=t,this.pluginConfig=e,this.div=n,this.utils=this.player.utils,this.playerConfig=this.player.getConfig(),this.playlistItemManager=null,this.playerKey=this.playerConfig.key,this.casting=!1,this.player.pauseAd=this.pauseAd.bind(this),this.player.skipAd=this.skipAd.bind(this),this.player.skipAdBreak=this.skipAdBreak.bind(this),this.destroyAdsManager=this.destroyAdsManager.bind(this),this.handleDependencyError=this.handleDependencyError.bind(this),this.sendCues=this.sendCues.bind(this)}lateInitAfterReady(){this.onReady();const t=this.player.getPlaylistItem();t&&this.onPlaylistItemCallback({item:t,index:this.player.getPlaylistIndex()})}onReady(){throw new Error("Not implemented.")}onPlaylistItemCallback(){throw new Error("Not implemented.")}destroyAdsManager(){this.playlistItemManager&&(this.playlistItemManager.destroy(),this.playlistItemManager=null)}handleDependencyError(t,e){this.destroyAdsManager(),this.player.off(null,null,this),this.client===n&&(this.player.playAd=this.utils.noop),this.player.trigger(f,{id:_,client:this.client,message:t,code:900,adErrorCode:e,tag:""})}pauseAd(t,e=null){this.playlistItemManager&&(t?this.playlistItemManager.pause(e||{}):this.playlistItemManager.resume(e||{}))}skipAd(){var t;null!=this&&null!=(t=this.playlistItemManager)&&t.skipAd&&this.playlistItemManager.skipAd()}skipAdBreak(){var t;null!=this&&null!=(t=this.playlistItemManager)&&t.skipAdBreak&&this.playlistItemManager.skipAdBreak()}sendCues(t,e){const n=t.getMidRolls(),r=[];t.preRoll&&r.push(k(t.preRoll,e)),n.length&&n.forEach(t=>{"nonlinear"!==t._type&&r.push(k(t,e))}),t.postRoll&&r.push(k(t.postRoll,e)),this.player.addCues(r)}resetCues(){const t=this.player.getCues().filter(t=>"ads"!==t.cueType);this.player.setCues(t)}}const I=function(t,e,n,r){if(0!==r.indexOf(t))return!1;const i=parseFloat(r.slice(t.length));return!(i<e||i>n)&&i},M=I.bind(null,"800000",10,90),C=I.bind(null,"900000",10,90),j=I.bind(null,"JWIAB",1,999),x=I.bind(null,"120321",10,90),R=I.bind(null,"120241",10,90),S=I.bind(null,"18010",1,698),T=["18020012"];var O=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)};const L=/^[^:/?#]+:?\/\/[^/?#]+/,B=function(t,e){if(!t)return;if(!e)return t;let n,r="",i="";Object.keys(e).forEach(t=>{const n=e[t];r=`${r}${i}${t}=${n}`,i="&"});const s=(t=>{if(t)return new URL(t,window.location)})(t),o=s.pathname;return s.searchParams.has("cust_params")?s.searchParams.set("cust_params",`${r}&${s.searchParams.getAll("cust_params")}`):s.searchParams.set("cust_params",r),n=s.toString(),0===t.indexOf("./")?n=`.${n.substring(n.indexOf(o))}`:0===t.indexOf("../")?n=`..${n.substring(n.indexOf(o))}`:0!==t.indexOf(`${s.protocol}`)||t.includes("://")?0===t.indexOf("//")?n=n.replace(s.protocol,""):0!==t.indexOf("//")&&0===t.indexOf("/")?n=n.substring(n.indexOf(o)):0!==t.indexOf("/")&&0===t.indexOf(s.pathname.substring(1))&&(n=n.substring(n.indexOf(o)+1)):n=n.replace("://",":"),n},D=t=>t?new URL(t).hostname:"",U=(t,e=document.location.search)=>{if(t)return new URLSearchParams(e).getAll(t)},N="hb_jwvb",V="hb_jwcr",q={[[N]]:"VIEWABILITY",[[V]]:"COMPLETION_RATE",[["hb_jwiab"]]:"IAB_CONTEXTUAL",[["hb_jwbs"]]:"BRAND_SAFETY"},z=[N,V],$=/^(https?:\/\/).*.(?:ampproject.org|bing-amp.com)\/(?:.\/)*(.*)\/amp.*$/,W="IAB_CONTENT_2_2",H=function(){if(!((t,e)=>{if(t)return new URLSearchParams(t).has(e)})(document.location.search,"isAMP"))return;const t=U("consentValue").join(),e=U("consentGdpr").join();return t||e?{gdprApplies:e,consentData:t}:void 0},F=Date.now||function(){return(new Date).getTime()},Q=t=>{const e=(t=>{let e=window;for(;e;){try{if(e.frames[t])break}catch(t){}e=e===window.top?null:e.parent}return e})(`${t}Locator`);return null!==e&&function(n,r,i,s){const o=F(),a=e=>{let n=e?e.data:{};if("string"==typeof n)try{n=JSON.parse(n)}catch(t){n={}}const r=`${t}Return`;n[r]&&n[r].callId===o&&(removeEventListener("message",a),i(n[r].returnValue,n[r].success))};window.addEventListener("message",a,!1);const l=void 0!==s?"version":"parameter",u={[[`${t}Call`]]:{command:n,callId:o,parameter:s,[[l]]:r}};e.postMessage(JSON.stringify(u),"*")}};let X=null,G={gdprApplies:!0,consentData:""};const J=function(t=1e3){return null===X&&(X=new Promise(t=>{const e=window.__tcfapi||Q("__tcfapi");if(e)return e("getTCData",2,(e,n)=>{t(!1!==n?{gdprApplies:e.gdprApplies,consentData:e.tcString,addtlConsent:e.addtlConsent}:null)});const n=window.__cmp||Q("__cmp");if(n)return n("getConsentData",null,(e,n)=>{t(!1!==n?{gdprApplies:e.gdprApplies||e.isUserInEu,consentData:e.consentData}:null)});const r=H();return t(r||{gdprApplies:!1,consentData:""})}).then(t=>(t&&(G=t),G))),Promise.race([X,new Promise(e=>{setTimeout(e,t,G)})])},K=function(t){const e=t.advertising;if(null!=e&&e.placement){const t=e.placement.toLowerCase();if(h[t])return h[t]}return h[null!=e&&e.outstream?c:d]},Y=function(){const t=(e=document.referrer)&&null!==e.match(L)?function(t){const e=t.match($);return e&&e.length>1?`${e[1]}${e[2]}`:t}(document.referrer):"";var e;if(window.top!==window.self){try{return{url:window.top.location.href,domain:window.top.document.domain,referrer:t}}catch(t){}return{url:t,domain:D(t),referrer:""}}return{url:document.location.href,domain:document.domain,referrer:t}},Z=function(t,e,n=!0){if("start"===t||"0%"===t||n&&!t&&0!==t)return"pre";if("end"===t||"100%"===t)return"post";if("string"==typeof t&&("pre"===t||"post"===t||t.indexOf("%")>=0))return t;const r=e.seconds(t);return"number"==typeof r&&!isNaN(r)&&r},tt=function(t,e){const n=Z(t,e);return"pre"===n?0:"post"===n?-1:n},et=function(t,e){const n=t.getPlugin("inference"),r=e.jwpseg_client_side,i=e.jwpseg||[];let s;if(!r||!r.length||!n)return i;try{s=n.predict(r,e)}catch(t){return e.jwpseg||[]}return[...Object.keys(s).filter(t=>s[t]),...i.filter(t=>-1===r.indexOf(t))]},nt=function(t){const e=[],n=[],r=[],i=[];let s=Boolean(t.some(t=>/^1/.test(String(t))));for(let i of t){"string"!=typeof i&&(i=String(i));const t=M(i);if(t){e.push(t);continue}const o=x(i);if(o){e.push(o);continue}const a=C(i);if(a){n.push(a);continue}const l=R(i);if(l){n.push(l);continue}const u=j(i);if(u){r.push(u);continue}const d=S(i);d?r.push(d):T.includes(String(i))?s=!1:"JWBRSAFE"!==i||(s=!0)}if(s&&i.push(1),e.length||n.length||r.length||i.length){const t={hb_jwvb:e,hb_jwcr:n,hb_jwiab:r,hb_jwbs:i};return Object.keys(t).forEach(e=>{t[e]=[...new Set(t[e])]}),t}return null},rt=function(t,e){e&&"object"==typeof e&&Object.keys(e).forEach(n=>{const r=e[n];if(!r||"object"!=typeof r)return;const i=function(t,e,n){if(n&&e&&e.length)return n.sendIsIncluded?`HAS_${q[t]||"SEGMENT"}`:n.sendMax&&z.includes(t)?e.reduce((t,e)=>Math.max(t,e),-1/0):void 0}(n,t[n],r);void 0!==i&&(t[n]=[i])})},it=function(t){const{player:e,item:n,tag:r,targetingConfig:i,enablePPS:s=!1}=t,o=et(e,n);if(!o.length)return r;const a=nt(o);if(!a)return r;rt(a,i);const l=function(t){if(!t)return;const e=[];for(const n in t)O(t,n)&&t[n].length&&e.push(`${n}=${t[n]}`);return e.join("&")}(a),u=new URL(r,window.location),d=u.searchParams,c=d.getAll("cust_params").filter(t=>t).join("&");if(!d.get("ppsj")&&s){const t=(t=>{var e;return null!=t&&null!=(e=t.hb_jwiab)&&e.length?t.hb_jwiab.map(String):null})(a),e="boolean"==typeof s||!("encodePPS"in s)||s.encodePPS;t&&d.set("ppsj",((t,e)=>{if(!e)return t;const n={PublisherProvidedTaxonomySignals:[{taxonomy:W,values:t}]};return window.btoa(JSON.stringify(n))})(t,e)),s.includeIABTaxonomyVersion&&d.set("iabt_ver",W)}return c&&c.length>0?d.set("cust_params",`${c}&${l}`):d.set("cust_params",l),u.toString()},st=(t,e=!1)=>{const n=e?0===t.getPosition()&&"idle"===t.getState():0===t.getPosition();return t.isBeforePlay()||n?"pre":t.isBeforeComplete()||t.getPosition()===t.getDuration()?"post":"mid"};var ot=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)};const at=/^((https?:)?\/\/)?(secure)?pubads\.g\.doubleclick\.net\/gampad\/ads\?[\S]*$/,lt=function(t,e,n){for(;-1!==t.indexOf(e);)t=t.replace(e,n);return t},ut=function(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n},dt=function(r,i,s,o,a,l={}){var d,c,h,f,p,g,m;if(!r)return r;const y=function(t,e){const n=t.getConfig(),r=t.getPlaylistItem()===e,i={playerHeight:t.getHeight()||n.height||"",playerWidth:t.getWidth()||n.width||"",itemDuration:r&&ut(t.getDuration(),3)||"",integerDuration:r&&ut(e.duration,0)||"",item:e,jwpseg:et(t,e),placement:K(n),userAgent:navigator.userAgent},s=n.advertising?n.advertising.ampMacros:{};return Object.assign(i,s)}(i,s),v=Y();let _=null;null!=s&&s.jwpseg&&(_=nt(s.jwpseg));const w={viewability:(null==(d=_)||null==(c=d.hb_jwvb)?void 0:c.map(t=>encodeURIComponent(t)).join(","))||"",completion:(null==(h=_)||null==(f=h.hb_jwcr)?void 0:f.map(t=>encodeURIComponent(t)).join(","))||"",brandSafety:1===(null==(p=_)?void 0:p.hb_jwbs[0])?encodeURIComponent("Yes"):encodeURIComponent("No"),contextual:(null==(g=_)||null==(m=g.hb_jwiab)?void 0:m.map(t=>encodeURIComponent(t)).join(","))||""};-1!==r.indexOf(u)&&(l.jwpseg=y.jwpseg),r=lt(r,"__random-number__",()=>Math.random()*Math.pow(10,18)),r=lt(r,"__timestamp__",(new Date).getTime()),r=lt(r,"__page-url__",encodeURIComponent(y.pageUrl||v.url)),r=lt(r,"__referrer__",encodeURIComponent(y.referrer||v.referrer)),r=lt(r,"__player-height__",y.playerHeight),r=lt(r,"__player-width__",y.playerWidth),r=lt(r,"__item-duration__",y.itemDuration),r=lt(r,"__integer-duration__",y.integerDuration),r=lt(r,u,y.jwpseg),r=lt(r,"__domain__",encodeURIComponent(y.domain||v.domain)),r=lt(r,"__placement__",y.placement),r=lt(r,"__device-ua__",encodeURIComponent(y.userAgent)),r=lt(r,"__jw-viewability__",w.viewability),r=lt(r,"__jw-completion__",w.completion),r=lt(r,"__jw-brand-safety__",w.brandSafety),r=lt(r,"__jw-contextual__",w.contextual),r=a.companion?lt(r,"__companion-div__",a.companion.id):lt(r,"__companion-div__","");const A=Object.keys(y).filter(t=>-1!==t.indexOf("item")),b=A.map(t=>{const e=t.match(/item([\w]+?)(List)?$/);let n;return e&&(n=e[1].toLowerCase()),n});let P=null;const k=/__item-([\w-]+?)(-list)?__/g,E=r;for(;null!==(P=k.exec(E));){const t=P[0],e=P[1],n=A[b.indexOf(e)];let i="";if(ot(s,e)&&"string"==typeof s[e]||n){i=n?y[n]:s[e];const t=!1===a.truncateMacros?4096:1e3;i.length>t&&(i=i.substring(0,t));const r=P[2]?",":null;i=i.split(r).map(encodeURIComponent)}r=lt(r,t,i)}if(o===n)return r;if(o===t){const t=i.getConfig().autostart?1:0,e=i.getMute()?1:0;r=function(t,e,n){return at.test(t)&&(t=`${t}&vpa=${e}&vpmute=${n}`),t}(r,t,e)}if((o===e||"cnx"===o)&&s.title&&-1===r.indexOf("vid_t=")){const t=s.title.substring(0,100).replace(/[^\x00-\x7F]/g,"");r+=`${function(t){return-1!==t.indexOf("?")?"&":"?"}(r)}vid_t=${encodeURIComponent(t)}`}return-1!==r.indexOf("__gdpr__")||-1!==r.indexOf("__gdpr_consent__")||-1!==r.indexOf("__addtl_consent__")?J().then(({gdprApplies:t,consentData:e,addtlConsent:n})=>(r=lt(r,"__gdpr__",t?1:0),r=lt(r,"__addtl_consent__",n||""),lt(r,"__gdpr_consent__",e||""))).catch(()=>r):Promise.resolve(r)},ct=function(){},ht=function(t,e,n){let r=[];return t&&(r=t.getElementsByTagName(e),n&&r&&0===r.length&&(r=t.getElementsByTagName(`${n}:${e}`))),r},ft=function(t,e){return t?t.getAttribute(e):null},pt=function(t,e,n){t.push({message:e,code:1002,adErrorCode:70001,id:n})},gt=function(){const t=new Error("No AdBreaks in VMAP");throw t.adErrorCode=60005,t},mt=function(t){if(t){const e=t.textContent||t.text;if(e)return e.trim()}return""},yt=function(t,e,n,r){let i=[];return t||e?(i=e.getElementsByTagNameNS?e.getElementsByTagNameNS(t,n):e.getElementsByTagName(`${r}:${n}`),i):i},vt=function(t){return t.ownerDocument instanceof Document?t.outerHTML||(new XMLSerializer).serializeToString(t):null},_t=function(t,e){if(t){const n=t.getElementsByTagName(e);if(n)return n[0]}return null};let wt=function(t){(t.indexOf("[REGULATIONS]")>=0||t.indexOf("[GDPRCONSENT]")>=0)&&(J().catch(ct),wt=ct)};const At=function(t,e){let n=ft(e,"event");if("progress"===n){n=`${n}_${ft(e,"offset")}`}!function(t,e,n){t[e]||(t[e]=[]),n&&(t[e].push(n),wt(n))}(t,n,mt(e))},bt=function(t,e){if(!t)return null;const n=t.getElementsByTagName("Ad");if(!n.length)return null;const r={_offSet:e};if(1===n.length)r._adQueue=[n[0].textContent.trim()];else{r._pod=[];for(let t=0;t<n.length;t++)r._pod.push(n[t].textContent.trim())}return r},Pt=function(t,e,n){if(ht(t,"VMAP",w).length)return function(t,e,n){const r=[],i=ht(t,"VMAP",w);ft(i[0],"version")||pt(r,"VMAP Schema Error: version missing from VMAP tag",_);const s=ht(t,"AdBreak",w);s.length||gt();const o=t.lookupNamespaceURI(w),a={};for(let t=0;t<s.length;t++){const e={},n={},i=s[t],l=ft(i,"timeOffset")||0,u=ft(i,"breakId"),d=ft(i,"breakType"),c=ht(i,"AdSource",w)[0],h=ft(c,"id"),f=ht(i,"AdTagURI",w)[0],p=ht(i,"VASTData",w)[0]||ht(i,"VASTAdData",w)[0],g=ft(f,"templateType"),m=mt(f),y=yt(o,i,"Tracking",w);if(d||pt(r,"VMAP Schema Error: missing breakType on AdBreak",u),p||g||pt(r,"VMAP Schema Error: missing templateType on AdBreak",u),l||pt(r,"VMAP Schema Error: missing timeOffset on AdBreak",u),e._type=d,e._vmap={id:h,breakid:u,timeoffset:l},p)e._adXML=vt(_t(p,"VAST"));else{if("vast2"!==g&&"vast3"!==g&&"vast4"!==g)continue;e._adQueue=[m],e._waterfallIndex=0}const v=[];if(y)for(let t=0;t<y.length;t++){At(n,y[t]);const e=ft(y[t],"event");v.push(e)}(v.indexOf("breakStart")<0||v.indexOf("breakEnd")<0||v.indexOf("error")<0)&&pt(r,"Tracking events are missing breakStart, breakEnd, or error for AdBreak",u),e._trackers=n,e._type=d;const _="number"==typeof l||"string"==typeof l;_&&!a[l]?(a[l]=e,a[l]._pod=e._adQueue?[...e._adQueue]:[]):_&&a[l]&&e._adQueue&&a[l]._pod.push(...e._adQueue)}return Object.keys(a).forEach(t=>{const r=a[t];switch(r._pod&&r._pod.length<=1&&delete r._pod,t){case"start":r._offSet="pre",e.setPreRoll(r);break;case"100%":case"end":r._offSet="post",e.setPostRoll(r);break;default:if(/^#/.test(t))break;/^\d\d?(?:\.\d+)?%$/.test(t)?r._offSet=t:r._offSet=n.seconds(t),e.addMidRoll(r)}}),e.preRoll||e.midRolls.length||e.postRoll||gt(),e.sort(null,!0),r}(t,e,n);if(ht(t,"Playlist",w).length)return function(t,e,n){const r=ht(t,"Playlist",w)[0],i=r.getElementsByTagName("Preroll")[0],s=r.getElementsByTagName("Postroll")[0],o=bt(i,"pre"),a=bt(s,"post");o&&e.setPreRoll(o),a&&e.setPostRoll(a);const l=r.getElementsByTagName("Midroll");for(let t=0;t<l.length;t++){const r=l[t],i=n.seconds(r.getAttribute("timeOffset")),s=bt(r,i);e.addMidRoll(s)}return[]}(t,e,n);throw new Error("No VMAP tag in response")},kt=function(t,e,n){if(null===t)return;let r;return Object.keys(t).forEach(e=>{const n=t[e];r=r||{},r[e]="_adQueue"===e||"_pod"===e?n.slice():n}),r?(r.requestTimeout=e,r.creativeTimeout=n,r._errors=[],r._waterfallIndex=0,r._adPodIndex=0,r):void 0},Et=function(t,e){return"%"===t.toString().slice(-1)?e*parseFloat(t.slice(0,-1))/100:parseFloat(t)};class It{constructor(t,e){this.adRules=t,this.utils=e,this.logger=this.utils.logger.child("ads-shared/Schedule"),this.preRoll=null,this.vmap={url:null,xml:null},this.postRoll=null,this.midRolls=[],this.playedMidRolls=[],this.duration=0,this._vmapPromise=null,this._vmapXHR=null}load(t,e,n,r){return this._vmapPromise||(this._vmapPromise=this._load(t,e,n,r)),this._vmapPromise}async _load(t,n,r,i){try{const{url:s,xml:o}=await this._prepareVMAP(t,n,r,i);if(r===e)return this._handleGoogimaVMAP(s,o),[];return await this._handleVastVMAP(t,r,i,s,o)}catch(e){throw this._mapErrorToEvent(t,e,this.getVMAPUrl())}}async _handleVastVMAP(t,e,n,r,i){let s;s=i?this.utils.parseXML(i):await this._fetchVMAP(r,n),t.trigger("adLoadedXML",{client:e,tag:r,vmapParsedXml:s});return Pt(s,this,this.utils).map(t=>Object.assign(t,{vmap:r||this.getVMAPUrl()}))}_fetchVMAP(t,e){return new Promise((n,r)=>{this._vmapXHR=this.utils.ajax({url:t,withCredentials:e.withCredentials,retryWithoutCredentials:!0,requireValidXML:!0,timeout:this.requestTimeout},t=>{this._vmapXHR=null,n(t.responseXML)},(t,e,n,i)=>{this._vmapXHR=null,r(i)})})}_handleGoogimaVMAP(t,e){e?this.setPreRoll({_adXML:e}):this.setPreRoll({_adQueue:[t]})}async _prepareVMAP(t,e,n,r){const i=this.getVMAPUrl();if(this.vmap.xml)return Object.assign({},this.vmap);return{url:await dt(i,t,e,n,r),xml:null}}_mapErrorToEvent(t,e,n){const r={id:_,vmap:n};if(null!=e&&e.message)Object.assign(r,{message:`VMAP Schema Error: ${e.message}`,code:1002,adErrorCode:(null==e?void 0:e.adErrorCode)||11002});else{const n={1:{code:1007,message:"Timeout"},602:{code:1e3,message:"Invalid XML"},default:{code:1008,message:t.getConfig().localization.errors[null==e?void 0:e.key]}},i=n[null==e?void 0:e.code]||n.default;this.logger.error(i.message),Object.assign(r,{message:"Error Loading VMAP Schedule",code:i.code,adErrorCode:i.code+1e4})}return r}canWaterfall(t){return t._adQueue&&t._waterfallIndex+1<t._adQueue.length}getPreRoll(t){return t&&"none"===this.adRules.startOnSeek?null:kt(this.preRoll,this.requestTimeout,this.creativeTimeout)}getPostRoll(t){const e=kt(this.postRoll,this.requestTimeout,this.creativeTimeout);return this.adRules.timeBetweenAdsAllowsAdPlayback(e,t)?e:null}getMidRollAtIndex(t){const e=this.midRolls[t];return kt(e,this.requestTimeout,this.creativeTimeout)}getLastMidRollIndexBetweenTime(t,e,n){if(t>e)return null;this.sort(n);let r=this.midRolls.length;for(;r--;){const i=this.midRolls[r],s=Et(this.midRolls[r]._offSet,n);if(t>=s)return null;if(e>=s){const t=kt(i,this.requestTimeout,this.creativeTimeout);if(!this.adRules.timeBetweenAdsAllowsAdPlayback(t))return null;if(!this.adRules.timeBetweenAds){if(this.playedMidRolls.indexOf(r)>=0)return null;this.playedMidRolls.push(r)}return r}}return null}peek(t,e,n){if(this.midRolls.length>this.playedMidRolls.length){this.sort(n);let r=0;for(;this.midRolls[r];){const i=this.midRolls[r],s=Et(i._offSet,n);if(s>=t&&-1===this.playedMidRolls.indexOf(r)){const n=F()+1e3*(s-t);return s<=e&&this.adRules.timeBetweenAdsAllowsAdPlayback(null,n)?r:null}r+=1}}const r=F()+1e3*(n-t);return this.postRoll&&e>=n&&this.adRules.timeBetweenAdsAllowsAdPlayback(null,r)?-1:null}getNextMidrollIndex(t,e,n){if(this.adRules.timeBetweenAds||this.adRules.startOnSeek)return this.getLastMidRollIndexBetweenTime(t,e,n);if(this.midRolls.length>this.playedMidRolls.length){const t=this.getClosestIndex(e,n);if(t>=0&&this.playedMidRolls.indexOf(t)<0)return this.playedMidRolls.push(t),t}return null}getMidRolls(){return this.midRolls.map(t=>kt(t,this.requestTimeout,this.creativeTimeout))}reset(){var t;null!==this._vmapXHR&&((t=this._vmapXHR).onload=t.onreadystatechange=t.onerror=null,"abort"in t&&t.abort(),this._vmapXHR=null),this.playedMidRolls=[],this.duration=0}setPreRoll(t){t&&this.resetBreakId(t),this.preRoll=t}addMidRoll(t){this.resetBreakId(t),this.midRolls.push(t),this.duration=0}setPostRoll(t){t&&this.resetBreakId(t),this.postRoll=t}sort(t,e){(!t||t<1)&&(t=1),(this.duration!==t||e)&&(this.duration=t,this.midRolls.forEach(e=>{e._offsetSeconds=Et(e._offSet,t)}),this.midRolls.sort((t,e)=>t._offsetSeconds-e._offsetSeconds),function(t,e){for(let n=0;n<t.length;n++){const r=t[n];e?r._vmap.item=n+1:(r._adbreak={item:n+1,breakid:r._breakId},r._pod?r._adbreak.pod=r._pod:r._adbreak.tags=r._adQueue)}}(this.getAllAds(),e))}getAllAds(){const t=this.preRoll?[this.preRoll]:[],e=this.postRoll?[this.postRoll]:[];return t.concat(this.midRolls,e)}setVMAP(t){const e=t.trim();this.isXmlVMAP(e)?this.vmap={url:null,xml:e}:this.vmap={url:e,xml:null}}isVMAP(){return Boolean(this.vmap.url||this.vmap.xml)}isXmlVMAP(t){if(!t)return!1;return/^<\?xml|<vmap:/i.test(t.trim())}getVMAPUrl(){return this.vmap.xml?"https://jwplayer.com/vmap.xml":this.vmap.url}getClosestIndex(t,e){this.sort(e);let n=this.midRolls.length;for(;n--;)if(t>=Et(this.midRolls[n]._offSet,e))return n;return-1}clearAds(){this.preRoll=null,this.midRolls.length=0,this.postRoll=null}resetBreakId(t){t.adBreakId=this.utils.genId(12)}resetAllBreakIds(){this.getAllAds().forEach(t=>{this.resetBreakId(t)})}destroy(){this.reset(),this.adRules.destroy()}}const Mt=function(t){return Array.isArray(t)?t.slice(0):[t]},Ct=function(t,e){return 0===t?1/0:t||e};class jt{constructor(t){this.utils=t}getSchedule(t,e){const n=new It(e,this.utils);if(n.requestTimeout=Ct(t.requestTimeout,5e3),n.creativeTimeout=Ct(t.creativeTimeout,5e3),t.tag)n.setPreRoll({_offSet:"pre",_adQueue:Mt(t.tag),_waterfallIndex:0});else if("string"==typeof t.vastxml)n.setPreRoll({_offSet:"pre",_adXML:t.vastxml});else{if("string"==typeof t.schedule)return n.setVMAP(t.schedule),n;if("string"==typeof t.adschedule)return n.setVMAP(t.adschedule),n;!function(t,e,n){const r=e.schedule||e.adschedule;if(!r)return;const i=n.logger.child("ads-shared/ConfigParser"),s={};Object.keys(r).forEach(t=>{const e=r[t];e.ad&&(Object.assign(e,e.ad),delete e.ad);const o=Z(e.offset,n),a=Ct(e.requestTimeout,5e3),l=Ct(e.creativeTimeout,5e3);let u=s[o];if(u){if("nonlinear"===e.type)return;"nonlinear"===u._type&&(u=null)}const d=s[o]=u||{_offSet:o,_type:e.type,_breakId:t,adBreakId:n.genId(12),requestTimeout:a,creativeTimeout:l};!1===o&&i.error("Error: ad offset format not supported",o);const c=e.skipoffset;if(void 0!==c&&void 0===d.skipoffset&&(d.skipoffset=c),"string"==typeof e.adm)d.adm=e.adm;else if(e.pod){const t=d._pod||[];d._pod=t.concat(e.pod)}else if(e.tag){const t=B(e.tag,e.custParams);d._adQueue&&(d._pod=[d._adQueue[0]],delete d._adQueue),d._pod?d._pod.push(Mt(t)[0]):d._adQueue=Mt(t)}else"string"==typeof e.vastxml?d._adXML=e.vastxml:i.error("Error: no ad tag provided")}),Object.keys(s).forEach(n=>{const r=s[n];switch(r.skipoffset=void 0!==r.skipoffset?r.skipoffset:e.skipoffset,n){case"pre":t.setPreRoll(r);break;case"post":t.setPostRoll(r);break;default:t.addMidRoll(r)}})}(n,t,this.utils)}return n.sort(),n}getOptParams(t,e){const n={cuetext:e.cuetext,dynamicMessage:e.admessage,loadingAd:e.loadingAd,podMessage:e.podmessage,skipoffset:t.skipoffset,skipmessage:e.skipmessage,skiptext:e.skiptext,omidAccessMode:t.omidAccessMode||"full",omidSupport:t.omidSupport||"auto",allowedOmidVendors:t.allowedOmidVendors||[],vpaidcontrols:t.vpaidcontrols||!1,conditionaladoptout:t.conditionaladoptout||!1,requestFilter:t.requestFilter,trackingFilter:t.trackingFilter,withCredentials:void 0===t.withCredentials||t.withCredentials,extensions:"[object Object]"===Object.prototype.toString.call(t.extensions)?t.extensions:{}},r=t.companiondiv;return r&&(n.companion={id:r.id,height:r.height,width:r.width}),n}getAdRules(t){const e=t.rules||{},n=parseInt(e.frequency,10);return{startOn:e.startOn||1,frequency:isNaN(n)?1:n,timeBetweenAds:e.timeBetweenAds||0,startOnSeek:e.startOnSeek||null,deferAds:e.deferAds||null}}}const xt=function(t,e=null,n={}){const r={client:t.client},{bidding:i,item:s,player:o}=t;if(t.isDestroyed()||Object.assign(r,{placement:K(o.getConfig()),viewable:o.getViewable()}),n.jwpseg&&(r.jwpseg=n.jwpseg),e){const{adBreakId:s,adPlayId:o}=t.getAdIds(e,n);if(Object.assign(r,{adBreakId:s,adPlayId:o,offset:e._offSet}),i){const t=i.getBid(o);t&&Object.assign(r,t.getEventObject())}}return r.item=s,r},Rt=function(t,e,n,r){return{client:r,message:t,adErrorCode:e,id:_,placement:K(n),tag:""}};class St{constructor(t,e){this.player=t,this.options=e,this.client=e.client,this.ignoreStartOnSeek=!1,this.reset(),e.timeBetweenAds&&t.on({adBreakStart:this.handleAdBreakStart,adSkipped:this.handleAdSkipped,adComplete:this.handleAdComplete,adBreakEnd:this.handleAdBreakEnd,destroyPlugin:this.destroy},this)}get timeBetweenAds(){return this.options.timeBetweenAds}get startOnSeek(){return this.ignoreStartOnSeek?null:this.options.startOnSeek}shouldDeferAds(){return this.options.deferAds&&!this.player.getConfig().activeTab}clearStartOnSeek(){this.ignoreStartOnSeek=!0}sendAdBreakIgnored(t,e){t&&this.player.trigger(l,function(t,e){let n={};return t&&(n={id:t._breakId,tag:t._adQueue&&t._adQueue.length>0?t._adQueue[0]:t._adXML,offset:t._offSet}),Object.assign(n,{timeSinceLastAd:e,type:l})}(t,e,this.client))}rulesAllowAdPlayback(t){const e=this.options,n=0===e.frequency&&1===t,r=t>=e.startOn&&(t-e.startOn)%e.frequency===0;return n||r}handleAdBreakStart(){this.adSkipped=!1,this.adComplete=!1}handleAdComplete(){this.adComplete=!0}handleAdSkipped(){this.adSkipped=!0}handleAdBreakEnd(){!this.adSkipped&&this.adComplete&&(this.recentCompletedAdTime=F(),this.player.trigger("previousAdCompleteTime",{time:this.recentCompletedAdTime}))}timeBetweenAdsAllowsAdPlayback(t,e=F()){if(this.options.timeBetweenAds){const n=(e-this.recentCompletedAdTime)/1e3;if(n<this.options.timeBetweenAds)return this.sendAdBreakIgnored(t,n),!1}return!0}reset(){this.ignoreStartOnSeek=!1,this.recentCompletedAdTime=0}destroy(){this.player.off(null,null,this)}}class Tt{constructor(t,e,n){this.player=t,this.pluginConfig=e,this.adClient=n;const r=this.configParser=new jt(t.utils),i=this.adRules=new St(t,r.getAdRules(e),n);this.emptySchedule=new It(i,t.utils),this.logger=this.player.utils.logger.child("ads-shared/ConfigScheduleParser")}getAdRules(){return this.adRules}resetDefaultSchedule(t){const e=void 0===this.pluginConfig.withCredentials||this.pluginConfig.withCredentials,n=this.defaultSchedule=this.configParser.getSchedule(this.pluginConfig,this.adRules);n.isVMAP()&&n.load(this.player,t,this.adClient,{withCredentials:e}).catch(t=>this.logger.debug(t))}getSchedule(t,e){var n;return e>0&&!this.adRules.rulesAllowAdPlayback(e)?this.emptySchedule:null!=t&&t.adschedule&&!0!==(null==(n=this.pluginConfig)?void 0:n.ignorePlaylistSchedules)?this.configParser.getSchedule(t,this.adRules):(this.resetDefaultSchedule(t),this.defaultSchedule)}getOptParams(t,e){return this.configParser.getOptParams(t,e)}reset(){this.adRules.reset()}destroy(){this.emptySchedule&&this.emptySchedule.destroy(),this.defaultSchedule&&this.defaultSchedule.destroy()}}var Ot,Lt,Bt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Dt={exports:{}};
/**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   */
Ot=Dt,Lt=Dt.exports,function(){var t,e="Expected a function",n="__lodash_hash_undefined__",r="__lodash_placeholder__",i=16,s=32,o=64,a=128,l=256,u=1/0,d=9007199254740991,c=NaN,h=4294967295,f=[["ary",a],["bind",1],["bindKey",2],["curry",8],["curryRight",i],["flip",512],["partial",s],["partialRight",o],["rearg",l]],p="[object Arguments]",g="[object Array]",m="[object Boolean]",y="[object Date]",v="[object Error]",_="[object Function]",w="[object GeneratorFunction]",A="[object Map]",b="[object Number]",P="[object Object]",k="[object Promise]",E="[object RegExp]",I="[object Set]",M="[object String]",C="[object Symbol]",j="[object WeakMap]",x="[object ArrayBuffer]",R="[object DataView]",S="[object Float32Array]",T="[object Float64Array]",O="[object Int8Array]",L="[object Int16Array]",B="[object Int32Array]",D="[object Uint8Array]",U="[object Uint8ClampedArray]",N="[object Uint16Array]",V="[object Uint32Array]",q=/\b__p \+= '';/g,z=/\b(__p \+=) '' \+/g,$=/(__e\(.*?\)|\b__t\)) \+\n'';/g,W=/&(?:amp|lt|gt|quot|#39);/g,H=/[&<>"']/g,F=RegExp(W.source),Q=RegExp(H.source),X=/<%-([\s\S]+?)%>/g,G=/<%([\s\S]+?)%>/g,J=/<%=([\s\S]+?)%>/g,K=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Y=/^\w*$/,Z=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/[\\^$.*+?()[\]{}|]/g,et=RegExp(tt.source),nt=/^\s+/,rt=/\s/,it=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,st=/\{\n\/\* \[wrapped with (.+)\] \*/,ot=/,? & /,at=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,lt=/[()=,{}\[\]\/\s]/,ut=/\\(\\)?/g,dt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ct=/\w*$/,ht=/^[-+]0x[0-9a-f]+$/i,ft=/^0b[01]+$/i,pt=/^\[object .+?Constructor\]$/,gt=/^0o[0-7]+$/i,mt=/^(?:0|[1-9]\d*)$/,yt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,vt=/($^)/,_t=/['\n\r\u2028\u2029\\]/g,wt="\\ud800-\\udfff",At="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",bt="\\u2700-\\u27bf",Pt="a-z\\xdf-\\xf6\\xf8-\\xff",kt="A-Z\\xc0-\\xd6\\xd8-\\xde",Et="\\ufe0e\\ufe0f",It="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Mt="['’]",Ct="["+wt+"]",jt="["+It+"]",xt="["+At+"]",Rt="\\d+",St="["+bt+"]",Tt="["+Pt+"]",Dt="[^"+wt+It+Rt+bt+Pt+kt+"]",Ut="\\ud83c[\\udffb-\\udfff]",Nt="[^"+wt+"]",Vt="(?:\\ud83c[\\udde6-\\uddff]){2}",qt="[\\ud800-\\udbff][\\udc00-\\udfff]",zt="["+kt+"]",$t="\\u200d",Wt="(?:"+Tt+"|"+Dt+")",Ht="(?:"+zt+"|"+Dt+")",Ft="(?:['’](?:d|ll|m|re|s|t|ve))?",Qt="(?:['’](?:D|LL|M|RE|S|T|VE))?",Xt="(?:"+xt+"|"+Ut+")?",Gt="["+Et+"]?",Jt=Gt+Xt+"(?:"+$t+"(?:"+[Nt,Vt,qt].join("|")+")"+Gt+Xt+")*",Kt="(?:"+[St,Vt,qt].join("|")+")"+Jt,Yt="(?:"+[Nt+xt+"?",xt,Vt,qt,Ct].join("|")+")",Zt=RegExp(Mt,"g"),te=RegExp(xt,"g"),ee=RegExp(Ut+"(?="+Ut+")|"+Yt+Jt,"g"),ne=RegExp([zt+"?"+Tt+"+"+Ft+"(?="+[jt,zt,"$"].join("|")+")",Ht+"+"+Qt+"(?="+[jt,zt+Wt,"$"].join("|")+")",zt+"?"+Wt+"+"+Ft,zt+"+"+Qt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rt,Kt].join("|"),"g"),re=RegExp("["+$t+wt+At+Et+"]"),ie=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,se=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],oe=-1,ae={};ae[S]=ae[T]=ae[O]=ae[L]=ae[B]=ae[D]=ae[U]=ae[N]=ae[V]=!0,ae[p]=ae[g]=ae[x]=ae[m]=ae[R]=ae[y]=ae[v]=ae[_]=ae[A]=ae[b]=ae[P]=ae[E]=ae[I]=ae[M]=ae[j]=!1;var le={};le[p]=le[g]=le[x]=le[R]=le[m]=le[y]=le[S]=le[T]=le[O]=le[L]=le[B]=le[A]=le[b]=le[P]=le[E]=le[I]=le[M]=le[C]=le[D]=le[U]=le[N]=le[V]=!0,le[v]=le[_]=le[j]=!1;var ue={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},de=parseFloat,ce=parseInt,he="object"==typeof Bt&&Bt&&Bt.Object===Object&&Bt,fe="object"==typeof self&&self&&self.Object===Object&&self,pe=he||fe||Function("return this")(),ge=Lt&&!Lt.nodeType&&Lt,me=ge&&Ot&&!Ot.nodeType&&Ot,ye=me&&me.exports===ge,ve=ye&&he.process,_e=function(){try{var t=me&&me.require&&me.require("util").types;return t||ve&&ve.binding&&ve.binding("util")}catch(t){}}(),we=_e&&_e.isArrayBuffer,Ae=_e&&_e.isDate,be=_e&&_e.isMap,Pe=_e&&_e.isRegExp,ke=_e&&_e.isSet,Ee=_e&&_e.isTypedArray;function Ie(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Me(t,e,n,r){for(var i=-1,s=null==t?0:t.length;++i<s;){var o=t[i];e(r,o,n(o),t)}return r}function Ce(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function je(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function xe(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Re(t,e){for(var n=-1,r=null==t?0:t.length,i=0,s=[];++n<r;){var o=t[n];e(o,n,t)&&(s[i++]=o)}return s}function Se(t,e){return!(null==t||!t.length)&&ze(t,e,0)>-1}function Te(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Oe(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Le(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Be(t,e,n,r){var i=-1,s=null==t?0:t.length;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n}function De(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function Ue(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Ne=Fe("length");function Ve(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function qe(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}function ze(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):qe(t,We,n)}function $e(t,e,n,r){for(var i=n-1,s=t.length;++i<s;)if(r(t[i],e))return i;return-1}function We(t){return t!=t}function He(t,e){var n=null==t?0:t.length;return n?Ge(t,e)/n:c}function Fe(e){return function(n){return null==n?t:n[e]}}function Qe(e){return function(n){return null==e?t:e[n]}}function Xe(t,e,n,r,i){return i(t,function(t,i,s){n=r?(r=!1,t):e(n,t,i,s)}),n}function Ge(e,n){for(var r,i=-1,s=e.length;++i<s;){var o=n(e[i]);o!==t&&(r=r===t?o:r+o)}return r}function Je(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ke(t){return t?t.slice(0,gn(t)+1).replace(nt,""):t}function Ye(t){return function(e){return t(e)}}function Ze(t,e){return Oe(e,function(e){return t[e]})}function tn(t,e){return t.has(e)}function en(t,e){for(var n=-1,r=t.length;++n<r&&ze(e,t[n],0)>-1;);return n}function nn(t,e){for(var n=t.length;n--&&ze(e,t[n],0)>-1;);return n}var rn=Qe({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),sn=Qe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function on(t){return"\\"+ue[t]}function an(t){return re.test(t)}function ln(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function un(t,e){return function(n){return t(e(n))}}function dn(t,e){for(var n=-1,i=t.length,s=0,o=[];++n<i;){var a=t[n];a!==e&&a!==r||(t[n]=r,o[s++]=n)}return o}function cn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function hn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function fn(t){return an(t)?function(t){for(var e=ee.lastIndex=0;ee.test(t);)++e;return e}(t):Ne(t)}function pn(t){return an(t)?function(t){return t.match(ee)||[]}(t):function(t){return t.split("")}(t)}function gn(t){for(var e=t.length;e--&&rt.test(t.charAt(e)););return e}var mn=Qe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),yn=function rt(wt){var At,bt=(wt=null==wt?pe:yn.defaults(pe.Object(),wt,yn.pick(pe,se))).Array,Pt=wt.Date,kt=wt.Error,Et=wt.Function,It=wt.Math,Mt=wt.Object,Ct=wt.RegExp,jt=wt.String,xt=wt.TypeError,Rt=bt.prototype,St=Et.prototype,Tt=Mt.prototype,Ot=wt["__core-js_shared__"],Lt=St.toString,Bt=Tt.hasOwnProperty,Dt=0,Ut=(At=/[^.]+$/.exec(Ot&&Ot.keys&&Ot.keys.IE_PROTO||""))?"Symbol(src)_1."+At:"",Nt=Tt.toString,Vt=Lt.call(Mt),qt=pe._,zt=Ct("^"+Lt.call(Bt).replace(tt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$t=ye?wt.Buffer:t,Wt=wt.Symbol,Ht=wt.Uint8Array,Ft=$t?$t.allocUnsafe:t,Qt=un(Mt.getPrototypeOf,Mt),Xt=Mt.create,Gt=Tt.propertyIsEnumerable,Jt=Rt.splice,Kt=Wt?Wt.isConcatSpreadable:t,Yt=Wt?Wt.iterator:t,ee=Wt?Wt.toStringTag:t,re=function(){try{var t=hs(Mt,"defineProperty");return t({},"",{}),t}catch(t){}}(),ue=wt.clearTimeout!==pe.clearTimeout&&wt.clearTimeout,he=Pt&&Pt.now!==pe.Date.now&&Pt.now,fe=wt.setTimeout!==pe.setTimeout&&wt.setTimeout,ge=It.ceil,me=It.floor,ve=Mt.getOwnPropertySymbols,_e=$t?$t.isBuffer:t,Ne=wt.isFinite,Qe=Rt.join,vn=un(Mt.keys,Mt),_n=It.max,wn=It.min,An=Pt.now,bn=wt.parseInt,Pn=It.random,kn=Rt.reverse,En=hs(wt,"DataView"),In=hs(wt,"Map"),Mn=hs(wt,"Promise"),Cn=hs(wt,"Set"),jn=hs(wt,"WeakMap"),xn=hs(Mt,"create"),Rn=jn&&new jn,Sn={},Tn=Us(En),On=Us(In),Ln=Us(Mn),Bn=Us(Cn),Dn=Us(jn),Un=Wt?Wt.prototype:t,Nn=Un?Un.valueOf:t,Vn=Un?Un.toString:t;function qn(t){if(na(t)&&!Ho(t)&&!(t instanceof Hn)){if(t instanceof Wn)return t;if(Bt.call(t,"__wrapped__"))return Ns(t)}return new Wn(t)}var zn=function(){function e(){}return function(n){if(!ea(n))return{};if(Xt)return Xt(n);e.prototype=n;var r=new e;return e.prototype=t,r}}();function $n(){}function Wn(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}function Hn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=h,this.__views__=[]}function Fn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Qn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Xn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Gn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Xn;++e<n;)this.add(t[e])}function Jn(t){var e=this.__data__=new Qn(t);this.size=e.size}function Kn(t,e){var n=Ho(t),r=!n&&Wo(t),i=!n&&!r&&Go(t),s=!n&&!r&&!i&&da(t),o=n||r||i||s,a=o?Je(t.length,jt):[],l=a.length;for(var u in t)!e&&!Bt.call(t,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||_s(u,l))||a.push(u);return a}function Yn(e){var n=e.length;return n?e[Gr(0,n-1)]:t}function Zn(t,e){return Ls(xi(t),lr(e,0,t.length))}function tr(t){return Ls(xi(t))}function er(e,n,r){(r!==t&&!qo(e[n],r)||r===t&&!(n in e))&&or(e,n,r)}function nr(e,n,r){var i=e[n];Bt.call(e,n)&&qo(i,r)&&(r!==t||n in e)||or(e,n,r)}function rr(t,e){for(var n=t.length;n--;)if(qo(t[n][0],e))return n;return-1}function ir(t,e,n,r){return fr(t,function(t,i,s){e(r,t,n(t),s)}),r}function sr(t,e){return t&&Ri(e,Sa(e),t)}function or(t,e,n){"__proto__"==e&&re?re(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ar(e,n){for(var r=-1,i=n.length,s=bt(i),o=null==e;++r<i;)s[r]=o?t:Ma(e,n[r]);return s}function lr(e,n,r){return e==e&&(r!==t&&(e=e<=r?e:r),n!==t&&(e=e>=n?e:n)),e}function ur(e,n,r,i,s,o){var a,l=1&n,u=2&n,d=4&n;if(r&&(a=s?r(e,i,s,o):r(e)),a!==t)return a;if(!ea(e))return e;var c=Ho(e);if(c){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Bt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(e),!l)return xi(e,a)}else{var h=gs(e),f=h==_||h==w;if(Go(e))return ki(e,l);if(h==P||h==p||f&&!s){if(a=u||f?{}:ys(e),!l)return u?function(t,e){return Ri(t,ps(t),e)}(e,function(t,e){return t&&Ri(e,Ta(e),t)}(a,e)):function(t,e){return Ri(t,fs(t),e)}(e,sr(a,e))}else{if(!le[h])return s?e:{};a=function(t,e,n){var r,i=t.constructor;switch(e){case x:return Ei(t);case m:case y:return new i(+t);case R:return function(t,e){var n=e?Ei(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case S:case T:case O:case L:case B:case D:case U:case N:case V:return Ii(t,n);case A:return new i;case b:case M:return new i(t);case E:return function(t){var e=new t.constructor(t.source,ct.exec(t));return e.lastIndex=t.lastIndex,e}(t);case I:return new i;case C:return r=t,Nn?Mt(Nn.call(r)):{}}}(e,h,l)}}o||(o=new Jn);var g=o.get(e);if(g)return g;o.set(e,a),aa(e)?e.forEach(function(t){a.add(ur(t,n,r,t,e,o))}):ra(e)&&e.forEach(function(t,i){a.set(i,ur(t,n,r,i,e,o))});var v=c?t:(d?u?ss:is:u?Ta:Sa)(e);return Ce(v||e,function(t,i){v&&(t=e[i=t]),nr(a,i,ur(t,n,r,i,e,o))}),a}function dr(e,n,r){var i=r.length;if(null==e)return!i;for(e=Mt(e);i--;){var s=r[i],o=n[s],a=e[s];if(a===t&&!(s in e)||!o(a))return!1}return!0}function cr(n,r,i){if("function"!=typeof n)throw new xt(e);return Rs(function(){n.apply(t,i)},r)}function hr(t,e,n,r){var i=-1,s=Se,o=!0,a=t.length,l=[],u=e.length;if(!a)return l;n&&(e=Oe(e,Ye(n))),r?(s=Te,o=!1):e.length>=200&&(s=tn,o=!1,e=new Gn(e));t:for(;++i<a;){var d=t[i],c=null==n?d:n(d);if(d=r||0!==d?d:0,o&&c==c){for(var h=u;h--;)if(e[h]===c)continue t;l.push(d)}else s(e,c,r)||l.push(d)}return l}qn.templateSettings={escape:X,evaluate:G,interpolate:J,variable:"",imports:{_:qn}},qn.prototype=$n.prototype,qn.prototype.constructor=qn,Wn.prototype=zn($n.prototype),Wn.prototype.constructor=Wn,Hn.prototype=zn($n.prototype),Hn.prototype.constructor=Hn,Fn.prototype.clear=function(){this.__data__=xn?xn(null):{},this.size=0},Fn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Fn.prototype.get=function(e){var r=this.__data__;if(xn){var i=r[e];return i===n?t:i}return Bt.call(r,e)?r[e]:t},Fn.prototype.has=function(e){var n=this.__data__;return xn?n[e]!==t:Bt.call(n,e)},Fn.prototype.set=function(e,r){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=xn&&r===t?n:r,this},Qn.prototype.clear=function(){this.__data__=[],this.size=0},Qn.prototype.delete=function(t){var e=this.__data__,n=rr(e,t);return!(n<0||(n==e.length-1?e.pop():Jt.call(e,n,1),--this.size,0))},Qn.prototype.get=function(e){var n=this.__data__,r=rr(n,e);return r<0?t:n[r][1]},Qn.prototype.has=function(t){return rr(this.__data__,t)>-1},Qn.prototype.set=function(t,e){var n=this.__data__,r=rr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Xn.prototype.clear=function(){this.size=0,this.__data__={hash:new Fn,map:new(In||Qn),string:new Fn}},Xn.prototype.delete=function(t){var e=ds(this,t).delete(t);return this.size-=e?1:0,e},Xn.prototype.get=function(t){return ds(this,t).get(t)},Xn.prototype.has=function(t){return ds(this,t).has(t)},Xn.prototype.set=function(t,e){var n=ds(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Gn.prototype.add=Gn.prototype.push=function(t){return this.__data__.set(t,n),this},Gn.prototype.has=function(t){return this.__data__.has(t)},Jn.prototype.clear=function(){this.__data__=new Qn,this.size=0},Jn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Jn.prototype.get=function(t){return this.__data__.get(t)},Jn.prototype.has=function(t){return this.__data__.has(t)},Jn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Qn){var r=n.__data__;if(!In||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Xn(r)}return n.set(t,e),this.size=n.size,this};var fr=Oi(Ar),pr=Oi(br,!0);function gr(t,e){var n=!0;return fr(t,function(t,r,i){return n=!!e(t,r,i)}),n}function mr(e,n,r){for(var i=-1,s=e.length;++i<s;){var o=e[i],a=n(o);if(null!=a&&(l===t?a==a&&!ua(a):r(a,l)))var l=a,u=o}return u}function yr(t,e){var n=[];return fr(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function vr(t,e,n,r,i){var s=-1,o=t.length;for(n||(n=vs),i||(i=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?vr(a,e-1,n,r,i):Le(i,a):r||(i[i.length]=a)}return i}var _r=Li(),wr=Li(!0);function Ar(t,e){return t&&_r(t,e,Sa)}function br(t,e){return t&&wr(t,e,Sa)}function Pr(t,e){return Re(e,function(e){return Yo(t[e])})}function kr(e,n){for(var r=0,i=(n=wi(n,e)).length;null!=e&&r<i;)e=e[Ds(n[r++])];return r&&r==i?e:t}function Er(t,e,n){var r=e(t);return Ho(t)?r:Le(r,n(t))}function Ir(e){return null==e?e===t?"[object Undefined]":"[object Null]":ee&&ee in Mt(e)?function(e){var n=Bt.call(e,ee),r=e[ee];try{e[ee]=t;var i=!0}catch(t){}var s=Nt.call(e);return i&&(n?e[ee]=r:delete e[ee]),s}(e):function(t){return Nt.call(t)}(e)}function Mr(t,e){return t>e}function Cr(t,e){return null!=t&&Bt.call(t,e)}function jr(t,e){return null!=t&&e in Mt(t)}function xr(e,n,r){for(var i=r?Te:Se,s=e[0].length,o=e.length,a=o,l=bt(o),u=1/0,d=[];a--;){var c=e[a];a&&n&&(c=Oe(c,Ye(n))),u=wn(c.length,u),l[a]=!r&&(n||s>=120&&c.length>=120)?new Gn(a&&c):t}c=e[0];var h=-1,f=l[0];t:for(;++h<s&&d.length<u;){var p=c[h],g=n?n(p):p;if(p=r||0!==p?p:0,!(f?tn(f,g):i(d,g,r))){for(a=o;--a;){var m=l[a];if(!(m?tn(m,g):i(e[a],g,r)))continue t}f&&f.push(g),d.push(p)}}return d}function Rr(e,n,r){var i=null==(e=Cs(e,n=wi(n,e)))?e:e[Ds(Js(n))];return null==i?t:Ie(i,e,r)}function Sr(t){return na(t)&&Ir(t)==p}function Tr(e,n,r,i,s){return e===n||(null==e||null==n||!na(e)&&!na(n)?e!=e&&n!=n:function(e,n,r,i,s,o){var a=Ho(e),l=Ho(n),u=a?g:gs(e),d=l?g:gs(n),c=(u=u==p?P:u)==P,h=(d=d==p?P:d)==P,f=u==d;if(f&&Go(e)){if(!Go(n))return!1;a=!0,c=!1}if(f&&!c)return o||(o=new Jn),a||da(e)?ns(e,n,r,i,s,o):function(t,e,n,r,i,s,o){switch(n){case R:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!s(new Ht(t),new Ht(e)));case m:case y:case b:return qo(+t,+e);case v:return t.name==e.name&&t.message==e.message;case E:case M:return t==e+"";case A:var a=ln;case I:var l=1&r;if(a||(a=cn),t.size!=e.size&&!l)return!1;var u=o.get(t);if(u)return u==e;r|=2,o.set(t,e);var d=ns(a(t),a(e),r,i,s,o);return o.delete(t),d;case C:if(Nn)return Nn.call(t)==Nn.call(e)}return!1}(e,n,u,r,i,s,o);if(!(1&r)){var _=c&&Bt.call(e,"__wrapped__"),w=h&&Bt.call(n,"__wrapped__");if(_||w){var k=_?e.value():e,j=w?n.value():n;return o||(o=new Jn),s(k,j,r,i,o)}}return!!f&&(o||(o=new Jn),function(e,n,r,i,s,o){var a=1&r,l=is(e),u=l.length,d=is(n),c=d.length;if(u!=c&&!a)return!1;for(var h=u;h--;){var f=l[h];if(!(a?f in n:Bt.call(n,f)))return!1}var p=o.get(e),g=o.get(n);if(p&&g)return p==n&&g==e;var m=!0;o.set(e,n),o.set(n,e);for(var y=a;++h<u;){var v=e[f=l[h]],_=n[f];if(i)var w=a?i(_,v,f,n,e,o):i(v,_,f,e,n,o);if(!(w===t?v===_||s(v,_,r,i,o):w)){m=!1;break}y||(y="constructor"==f)}if(m&&!y){var A=e.constructor,b=n.constructor;A==b||!("constructor"in e)||!("constructor"in n)||"function"==typeof A&&A instanceof A&&"function"==typeof b&&b instanceof b||(m=!1)}return o.delete(e),o.delete(n),m}(e,n,r,i,s,o))}(e,n,r,i,Tr,s))}function Or(e,n,r,i){var s=r.length,o=s,a=!i;if(null==e)return!o;for(e=Mt(e);s--;){var l=r[s];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<o;){var u=(l=r[s])[0],d=e[u],c=l[1];if(a&&l[2]){if(d===t&&!(u in e))return!1}else{var h=new Jn;if(i)var f=i(d,c,u,e,n,h);if(!(f===t?Tr(c,d,3,i,h):f))return!1}}return!0}function Lr(t){return!(!ea(t)||(e=t,Ut&&Ut in e))&&(Yo(t)?zt:pt).test(Us(t));var e}function Br(t){return"function"==typeof t?t:null==t?il:"object"==typeof t?Ho(t)?zr(t[0],t[1]):qr(t):fl(t)}function Dr(t){if(!ks(t))return vn(t);var e=[];for(var n in Mt(t))Bt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Ur(t){if(!ea(t))return function(t){var e=[];if(null!=t)for(var n in Mt(t))e.push(n);return e}(t);var e=ks(t),n=[];for(var r in t)("constructor"!=r||!e&&Bt.call(t,r))&&n.push(r);return n}function Nr(t,e){return t<e}function Vr(t,e){var n=-1,r=Qo(t)?bt(t.length):[];return fr(t,function(t,i,s){r[++n]=e(t,i,s)}),r}function qr(t){var e=cs(t);return 1==e.length&&e[0][2]?Is(e[0][0],e[0][1]):function(n){return n===t||Or(n,t,e)}}function zr(e,n){return As(e)&&Es(n)?Is(Ds(e),n):function(r){var i=Ma(r,e);return i===t&&i===n?Ca(r,e):Tr(n,i,3)}}function $r(e,n,r,i,s){e!==n&&_r(n,function(o,a){if(s||(s=new Jn),ea(o))!function(e,n,r,i,s,o,a){var l=js(e,r),u=js(n,r),d=a.get(u);if(d)er(e,r,d);else{var c=o?o(l,u,r+"",e,n,a):t,h=c===t;if(h){var f=Ho(u),p=!f&&Go(u),g=!f&&!p&&da(u);c=u,f||p||g?Ho(l)?c=l:Xo(l)?c=xi(l):p?(h=!1,c=ki(u,!0)):g?(h=!1,c=Ii(u,!0)):c=[]:sa(u)||Wo(u)?(c=l,Wo(l)?c=va(l):ea(l)&&!Yo(l)||(c=ys(u))):h=!1}h&&(a.set(u,c),s(c,u,i,o,a),a.delete(u)),er(e,r,c)}}(e,n,a,r,$r,i,s);else{var l=i?i(js(e,a),o,a+"",e,n,s):t;l===t&&(l=o),er(e,a,l)}},Ta)}function Wr(e,n){var r=e.length;if(r)return _s(n+=n<0?r:0,r)?e[n]:t}function Hr(t,e,n){e=e.length?Oe(e,function(t){return Ho(t)?function(e){return kr(e,1===t.length?t[0]:t)}:t}):[il];var r=-1;e=Oe(e,Ye(us()));var i=Vr(t,function(t,n,i){var s=Oe(e,function(e){return e(t)});return{criteria:s,index:++r,value:t}});return function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(i,function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,s=e.criteria,o=i.length,a=n.length;++r<o;){var l=Mi(i[r],s[r]);if(l)return r>=a?l:l*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)})}function Fr(t,e,n){for(var r=-1,i=e.length,s={};++r<i;){var o=e[r],a=kr(t,o);n(a,o)&&ti(s,wi(o,t),a)}return s}function Qr(t,e,n,r){var i=r?$e:ze,s=-1,o=e.length,a=t;for(t===e&&(e=xi(e)),n&&(a=Oe(t,Ye(n)));++s<o;)for(var l=0,u=e[s],d=n?n(u):u;(l=i(a,d,l,r))>-1;)a!==t&&Jt.call(a,l,1),Jt.call(t,l,1);return t}function Xr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==s){var s=i;_s(i)?Jt.call(t,i,1):hi(t,i)}}return t}function Gr(t,e){return t+me(Pn()*(e-t+1))}function Jr(t,e){var n="";if(!t||e<1||e>d)return n;do{e%2&&(n+=t),(e=me(e/2))&&(t+=t)}while(e);return n}function Kr(t,e){return Ss(Ms(t,e,il),t+"")}function Yr(t){return Yn(qa(t))}function Zr(t,e){var n=qa(t);return Ls(n,lr(e,0,n.length))}function ti(e,n,r,i){if(!ea(e))return e;for(var s=-1,o=(n=wi(n,e)).length,a=o-1,l=e;null!=l&&++s<o;){var u=Ds(n[s]),d=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(s!=a){var c=l[u];(d=i?i(c,u,l):t)===t&&(d=ea(c)?c:_s(n[s+1])?[]:{})}nr(l,u,d),l=l[u]}return e}var ei=Rn?function(t,e){return Rn.set(t,e),t}:il,ni=re?function(t,e){return re(t,"toString",{configurable:!0,enumerable:!1,value:el(e),writable:!0})}:il;function ri(t){return Ls(qa(t))}function ii(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=bt(i);++r<i;)s[r]=t[r+e];return s}function si(t,e){var n;return fr(t,function(t,r,i){return!(n=e(t,r,i))}),!!n}function oi(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var s=r+i>>>1,o=t[s];null!==o&&!ua(o)&&(n?o<=e:o<e)?r=s+1:i=s}return i}return ai(t,e,il,n)}function ai(e,n,r,i){var s=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(n=r(n))!=n,l=null===n,u=ua(n),d=n===t;s<o;){var c=me((s+o)/2),h=r(e[c]),f=h!==t,p=null===h,g=h==h,m=ua(h);if(a)var y=i||g;else y=d?g&&(i||f):l?g&&f&&(i||!p):u?g&&f&&!p&&(i||!m):!p&&!m&&(i?h<=n:h<n);y?s=c+1:o=c}return wn(o,4294967294)}function li(t,e){for(var n=-1,r=t.length,i=0,s=[];++n<r;){var o=t[n],a=e?e(o):o;if(!n||!qo(a,l)){var l=a;s[i++]=0===o?0:o}}return s}function ui(t){return"number"==typeof t?t:ua(t)?c:+t}function di(t){if("string"==typeof t)return t;if(Ho(t))return Oe(t,di)+"";if(ua(t))return Vn?Vn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function ci(t,e,n){var r=-1,i=Se,s=t.length,o=!0,a=[],l=a;if(n)o=!1,i=Te;else if(s>=200){var u=e?null:Ji(t);if(u)return cn(u);o=!1,i=tn,l=new Gn}else l=e?[]:a;t:for(;++r<s;){var d=t[r],c=e?e(d):d;if(d=n||0!==d?d:0,o&&c==c){for(var h=l.length;h--;)if(l[h]===c)continue t;e&&l.push(c),a.push(d)}else i(l,c,n)||(l!==a&&l.push(c),a.push(d))}return a}function hi(t,e){return null==(t=Cs(t,e=wi(e,t)))||delete t[Ds(Js(e))]}function fi(t,e,n,r){return ti(t,e,n(kr(t,e)),r)}function pi(t,e,n,r){for(var i=t.length,s=r?i:-1;(r?s--:++s<i)&&e(t[s],s,t););return n?ii(t,r?0:s,r?s+1:i):ii(t,r?s+1:0,r?i:s)}function gi(t,e){var n=t;return n instanceof Hn&&(n=n.value()),Be(e,function(t,e){return e.func.apply(e.thisArg,Le([t],e.args))},n)}function mi(t,e,n){var r=t.length;if(r<2)return r?ci(t[0]):[];for(var i=-1,s=bt(r);++i<r;)for(var o=t[i],a=-1;++a<r;)a!=i&&(s[i]=hr(s[i]||o,t[a],e,n));return ci(vr(s,1),e,n)}function yi(e,n,r){for(var i=-1,s=e.length,o=n.length,a={};++i<s;){var l=i<o?n[i]:t;r(a,e[i],l)}return a}function vi(t){return Xo(t)?t:[]}function _i(t){return"function"==typeof t?t:il}function wi(t,e){return Ho(t)?t:As(t,e)?[t]:Bs(_a(t))}var Ai=Kr;function bi(e,n,r){var i=e.length;return r=r===t?i:r,!n&&r>=i?e:ii(e,n,r)}var Pi=ue||function(t){return pe.clearTimeout(t)};function ki(t,e){if(e)return t.slice();var n=t.length,r=Ft?Ft(n):new t.constructor(n);return t.copy(r),r}function Ei(t){var e=new t.constructor(t.byteLength);return new Ht(e).set(new Ht(t)),e}function Ii(t,e){var n=e?Ei(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Mi(e,n){if(e!==n){var r=e!==t,i=null===e,s=e==e,o=ua(e),a=n!==t,l=null===n,u=n==n,d=ua(n);if(!l&&!d&&!o&&e>n||o&&a&&u&&!l&&!d||i&&a&&u||!r&&u||!s)return 1;if(!i&&!o&&!d&&e<n||d&&r&&s&&!i&&!o||l&&r&&s||!a&&s||!u)return-1}return 0}function Ci(t,e,n,r){for(var i=-1,s=t.length,o=n.length,a=-1,l=e.length,u=_n(s-o,0),d=bt(l+u),c=!r;++a<l;)d[a]=e[a];for(;++i<o;)(c||i<s)&&(d[n[i]]=t[i]);for(;u--;)d[a++]=t[i++];return d}function ji(t,e,n,r){for(var i=-1,s=t.length,o=-1,a=n.length,l=-1,u=e.length,d=_n(s-a,0),c=bt(d+u),h=!r;++i<d;)c[i]=t[i];for(var f=i;++l<u;)c[f+l]=e[l];for(;++o<a;)(h||i<s)&&(c[f+n[o]]=t[i++]);return c}function xi(t,e){var n=-1,r=t.length;for(e||(e=bt(r));++n<r;)e[n]=t[n];return e}function Ri(e,n,r,i){var s=!r;r||(r={});for(var o=-1,a=n.length;++o<a;){var l=n[o],u=i?i(r[l],e[l],l,r,e):t;u===t&&(u=e[l]),s?or(r,l,u):nr(r,l,u)}return r}function Si(t,e){return function(n,r){var i=Ho(n)?Me:ir,s=e?e():{};return i(n,t,us(r,2),s)}}function Ti(e){return Kr(function(n,r){var i=-1,s=r.length,o=s>1?r[s-1]:t,a=s>2?r[2]:t;for(o=e.length>3&&"function"==typeof o?(s--,o):t,a&&ws(r[0],r[1],a)&&(o=s<3?t:o,s=1),n=Mt(n);++i<s;){var l=r[i];l&&e(n,l,i,o)}return n})}function Oi(t,e){return function(n,r){if(null==n)return n;if(!Qo(n))return t(n,r);for(var i=n.length,s=e?i:-1,o=Mt(n);(e?s--:++s<i)&&!1!==r(o[s],s,o););return n}}function Li(t){return function(e,n,r){for(var i=-1,s=Mt(e),o=r(e),a=o.length;a--;){var l=o[t?a:++i];if(!1===n(s[l],l,s))break}return e}}function Bi(e){return function(n){var r=an(n=_a(n))?pn(n):t,i=r?r[0]:n.charAt(0),s=r?bi(r,1).join(""):n.slice(1);return i[e]()+s}}function Di(t){return function(e){return Be(Ya(Wa(e).replace(Zt,"")),t,"")}}function Ui(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=zn(t.prototype),r=t.apply(n,e);return ea(r)?r:n}}function Ni(e){return function(n,r,i){var s=Mt(n);if(!Qo(n)){var o=us(r,3);n=Sa(n),r=function(t){return o(s[t],t,s)}}var a=e(n,r,i);return a>-1?s[o?n[a]:a]:t}}function Vi(n){return rs(function(r){var i=r.length,s=i,o=Wn.prototype.thru;for(n&&r.reverse();s--;){var a=r[s];if("function"!=typeof a)throw new xt(e);if(o&&!l&&"wrapper"==as(a))var l=new Wn([],!0)}for(s=l?s:i;++s<i;){var u=as(a=r[s]),d="wrapper"==u?os(a):t;l=d&&bs(d[0])&&424==d[1]&&!d[4].length&&1==d[9]?l[as(d[0])].apply(l,d[3]):1==a.length&&bs(a)?l[u]():l.thru(a)}return function(){var t=arguments,e=t[0];if(l&&1==t.length&&Ho(e))return l.plant(e).value();for(var n=0,s=i?r[n].apply(this,t):e;++n<i;)s=r[n].call(this,s);return s}})}function qi(e,n,r,i,s,o,l,u,d,c){var h=n&a,f=1&n,p=2&n,g=24&n,m=512&n,y=p?t:Ui(e);return function a(){for(var v=arguments.length,_=bt(v),w=v;w--;)_[w]=arguments[w];if(g)var A=ls(a),b=function(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}(_,A);if(i&&(_=Ci(_,i,s,g)),o&&(_=ji(_,o,l,g)),v-=b,g&&v<c){var P=dn(_,A);return Xi(e,n,qi,a.placeholder,r,_,P,u,d,c-v)}var k=f?r:this,E=p?k[e]:e;return v=_.length,u?_=function(e,n){for(var r=e.length,i=wn(n.length,r),s=xi(e);i--;){var o=n[i];e[i]=_s(o,r)?s[o]:t}return e}(_,u):m&&v>1&&_.reverse(),h&&d<v&&(_.length=d),this&&this!==pe&&this instanceof a&&(E=y||Ui(E)),E.apply(k,_)}}function zi(t,e){return function(n,r){return function(t,e,n,r){return Ar(t,function(t,i,s){e(r,n(t),i,s)}),r}(n,t,e(r),{})}}function $i(e,n){return function(r,i){var s;if(r===t&&i===t)return n;if(r!==t&&(s=r),i!==t){if(s===t)return i;"string"==typeof r||"string"==typeof i?(r=di(r),i=di(i)):(r=ui(r),i=ui(i)),s=e(r,i)}return s}}function Wi(t){return rs(function(e){return e=Oe(e,Ye(us())),Kr(function(n){var r=this;return t(e,function(t){return Ie(t,r,n)})})})}function Hi(e,n){var r=(n=n===t?" ":di(n)).length;if(r<2)return r?Jr(n,e):n;var i=Jr(n,ge(e/fn(n)));return an(n)?bi(pn(i),0,e).join(""):i.slice(0,e)}function Fi(e){return function(n,r,i){return i&&"number"!=typeof i&&ws(n,r,i)&&(r=i=t),n=pa(n),r===t?(r=n,n=0):r=pa(r),function(t,e,n,r){for(var i=-1,s=_n(ge((e-t)/(n||1)),0),o=bt(s);s--;)o[r?s:++i]=t,t+=n;return o}(n,r,i=i===t?n<r?1:-1:pa(i),e)}}function Qi(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ya(e),n=ya(n)),t(e,n)}}function Xi(e,n,r,i,a,l,u,d,c,h){var f=8&n;n|=f?s:o,4&(n&=~(f?o:s))||(n&=-4);var p=[e,n,a,f?l:t,f?u:t,f?t:l,f?t:u,d,c,h],g=r.apply(t,p);return bs(e)&&xs(g,p),g.placeholder=i,Ts(g,e,n)}function Gi(t){var e=It[t];return function(t,n){if(t=ya(t),(n=null==n?0:wn(ga(n),292))&&Ne(t)){var r=(_a(t)+"e").split("e");return+((r=(_a(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Ji=Cn&&1/cn(new Cn([,-0]))[1]==u?function(t){return new Cn(t)}:ul;function Ki(t){return function(e){var n=gs(e);return n==A?ln(e):n==I?hn(e):function(t,e){return Oe(e,function(e){return[e,t[e]]})}(e,t(e))}}function Yi(n,u,d,c,h,f,p,g){var m=2&u;if(!m&&"function"!=typeof n)throw new xt(e);var y=c?c.length:0;if(y||(u&=-97,c=h=t),p=p===t?p:_n(ga(p),0),g=g===t?g:ga(g),y-=h?h.length:0,u&o){var v=c,_=h;c=h=t}var w=m?t:os(n),A=[n,u,d,c,h,v,_,f,p,g];if(w&&function(t,e){var n=t[1],i=e[1],s=n|i,o=s<131,u=i==a&&8==n||i==a&&n==l&&t[7].length<=e[8]||384==i&&e[7].length<=e[8]&&8==n;if(!o&&!u)return t;1&i&&(t[2]=e[2],s|=1&n?0:4);var d=e[3];if(d){var c=t[3];t[3]=c?Ci(c,d,e[4]):d,t[4]=c?dn(t[3],r):e[4]}(d=e[5])&&(c=t[5],t[5]=c?ji(c,d,e[6]):d,t[6]=c?dn(t[5],r):e[6]),(d=e[7])&&(t[7]=d),i&a&&(t[8]=null==t[8]?e[8]:wn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=s}(A,w),n=A[0],u=A[1],d=A[2],c=A[3],h=A[4],!(g=A[9]=A[9]===t?m?0:n.length:_n(A[9]-y,0))&&24&u&&(u&=-25),u&&1!=u)b=8==u||u==i?function(e,n,r){var i=Ui(e);return function s(){for(var o=arguments.length,a=bt(o),l=o,u=ls(s);l--;)a[l]=arguments[l];var d=o<3&&a[0]!==u&&a[o-1]!==u?[]:dn(a,u);return(o-=d.length)<r?Xi(e,n,qi,s.placeholder,t,a,d,t,t,r-o):Ie(this&&this!==pe&&this instanceof s?i:e,this,a)}}(n,u,g):u!=s&&33!=u||h.length?qi.apply(t,A):function(t,e,n,r){var i=1&e,s=Ui(t);return function e(){for(var o=-1,a=arguments.length,l=-1,u=r.length,d=bt(u+a),c=this&&this!==pe&&this instanceof e?s:t;++l<u;)d[l]=r[l];for(;a--;)d[l++]=arguments[++o];return Ie(c,i?n:this,d)}}(n,u,d,c);else var b=function(t,e,n){var r=1&e,i=Ui(t);return function e(){return(this&&this!==pe&&this instanceof e?i:t).apply(r?n:this,arguments)}}(n,u,d);return Ts((w?ei:xs)(b,A),n,u)}function Zi(e,n,r,i){return e===t||qo(e,Tt[r])&&!Bt.call(i,r)?n:e}function ts(e,n,r,i,s,o){return ea(e)&&ea(n)&&(o.set(n,e),$r(e,n,t,ts,o),o.delete(n)),e}function es(e){return sa(e)?t:e}function ns(e,n,r,i,s,o){var a=1&r,l=e.length,u=n.length;if(l!=u&&!(a&&u>l))return!1;var d=o.get(e),c=o.get(n);if(d&&c)return d==n&&c==e;var h=-1,f=!0,p=2&r?new Gn:t;for(o.set(e,n),o.set(n,e);++h<l;){var g=e[h],m=n[h];if(i)var y=a?i(m,g,h,n,e,o):i(g,m,h,e,n,o);if(y!==t){if(y)continue;f=!1;break}if(p){if(!Ue(n,function(t,e){if(!tn(p,e)&&(g===t||s(g,t,r,i,o)))return p.push(e)})){f=!1;break}}else if(g!==m&&!s(g,m,r,i,o)){f=!1;break}}return o.delete(e),o.delete(n),f}function rs(e){return Ss(Ms(e,t,Hs),e+"")}function is(t){return Er(t,Sa,fs)}function ss(t){return Er(t,Ta,ps)}var os=Rn?function(t){return Rn.get(t)}:ul;function as(t){for(var e=t.name+"",n=Sn[e],r=Bt.call(Sn,e)?n.length:0;r--;){var i=n[r],s=i.func;if(null==s||s==t)return i.name}return e}function ls(t){return(Bt.call(qn,"placeholder")?qn:t).placeholder}function us(){var t=qn.iteratee||sl;return t=t===sl?Br:t,arguments.length?t(arguments[0],arguments[1]):t}function ds(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function cs(t){for(var e=Sa(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Es(i)]}return e}function hs(e,n){var r=function(e,n){return null==e?t:e[n]}(e,n);return Lr(r)?r:t}var fs=ve?function(t){return null==t?[]:(t=Mt(t),Re(ve(t),function(e){return Gt.call(t,e)}))}:ml,ps=ve?function(t){for(var e=[];t;)Le(e,fs(t)),t=Qt(t);return e}:ml,gs=Ir;function ms(t,e,n){for(var r=-1,i=(e=wi(e,t)).length,s=!1;++r<i;){var o=Ds(e[r]);if(!(s=null!=t&&n(t,o)))break;t=t[o]}return s||++r!=i?s:!!(i=null==t?0:t.length)&&ta(i)&&_s(o,i)&&(Ho(t)||Wo(t))}function ys(t){return"function"!=typeof t.constructor||ks(t)?{}:zn(Qt(t))}function vs(t){return Ho(t)||Wo(t)||!!(Kt&&t&&t[Kt])}function _s(t,e){var n=typeof t;return!!(e=null==e?d:e)&&("number"==n||"symbol"!=n&&mt.test(t))&&t>-1&&t%1==0&&t<e}function ws(t,e,n){if(!ea(n))return!1;var r=typeof e;return!!("number"==r?Qo(n)&&_s(e,n.length):"string"==r&&e in n)&&qo(n[e],t)}function As(t,e){if(Ho(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ua(t))||Y.test(t)||!K.test(t)||null!=e&&t in Mt(e)}function bs(t){var e=as(t),n=qn[e];if("function"!=typeof n||!(e in Hn.prototype))return!1;if(t===n)return!0;var r=os(n);return!!r&&t===r[0]}(En&&gs(new En(new ArrayBuffer(1)))!=R||In&&gs(new In)!=A||Mn&&gs(Mn.resolve())!=k||Cn&&gs(new Cn)!=I||jn&&gs(new jn)!=j)&&(gs=function(e){var n=Ir(e),r=n==P?e.constructor:t,i=r?Us(r):"";if(i)switch(i){case Tn:return R;case On:return A;case Ln:return k;case Bn:return I;case Dn:return j}return n});var Ps=Ot?Yo:yl;function ks(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Tt)}function Es(t){return t==t&&!ea(t)}function Is(e,n){return function(r){return null!=r&&r[e]===n&&(n!==t||e in Mt(r))}}function Ms(e,n,r){return n=_n(n===t?e.length-1:n,0),function(){for(var t=arguments,i=-1,s=_n(t.length-n,0),o=bt(s);++i<s;)o[i]=t[n+i];i=-1;for(var a=bt(n+1);++i<n;)a[i]=t[i];return a[n]=r(o),Ie(e,this,a)}}function Cs(t,e){return e.length<2?t:kr(t,ii(e,0,-1))}function js(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var xs=Os(ei),Rs=fe||function(t,e){return pe.setTimeout(t,e)},Ss=Os(ni);function Ts(t,e,n){var r=e+"";return Ss(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(it,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return Ce(f,function(n){var r="_."+n[0];e&n[1]&&!Se(t,r)&&t.push(r)}),t.sort()}(function(t){var e=t.match(st);return e?e[1].split(ot):[]}(r),n)))}function Os(e){var n=0,r=0;return function(){var i=An(),s=16-(i-r);if(r=i,s>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(t,arguments)}}function Ls(e,n){var r=-1,i=e.length,s=i-1;for(n=n===t?i:n;++r<n;){var o=Gr(r,s),a=e[o];e[o]=e[r],e[r]=a}return e.length=n,e}var Bs=function(t){var e=Lo(t,function(t){return 500===n.size&&n.clear(),t}),n=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Z,function(t,n,r,i){e.push(r?i.replace(ut,"$1"):n||t)}),e});function Ds(t){if("string"==typeof t||ua(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Us(t){if(null!=t){try{return Lt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ns(t){if(t instanceof Hn)return t.clone();var e=new Wn(t.__wrapped__,t.__chain__);return e.__actions__=xi(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Vs=Kr(function(t,e){return Xo(t)?hr(t,vr(e,1,Xo,!0)):[]}),qs=Kr(function(e,n){var r=Js(n);return Xo(r)&&(r=t),Xo(e)?hr(e,vr(n,1,Xo,!0),us(r,2)):[]}),zs=Kr(function(e,n){var r=Js(n);return Xo(r)&&(r=t),Xo(e)?hr(e,vr(n,1,Xo,!0),t,r):[]});function $s(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ga(n);return i<0&&(i=_n(r+i,0)),qe(t,us(e,3),i)}function Ws(e,n,r){var i=null==e?0:e.length;if(!i)return-1;var s=i-1;return r!==t&&(s=ga(r),s=r<0?_n(i+s,0):wn(s,i-1)),qe(e,us(n,3),s,!0)}function Hs(t){return null!=t&&t.length?vr(t,1):[]}function Fs(e){return e&&e.length?e[0]:t}var Qs=Kr(function(t){var e=Oe(t,vi);return e.length&&e[0]===t[0]?xr(e):[]}),Xs=Kr(function(e){var n=Js(e),r=Oe(e,vi);return n===Js(r)?n=t:r.pop(),r.length&&r[0]===e[0]?xr(r,us(n,2)):[]}),Gs=Kr(function(e){var n=Js(e),r=Oe(e,vi);return(n="function"==typeof n?n:t)&&r.pop(),r.length&&r[0]===e[0]?xr(r,t,n):[]});function Js(e){var n=null==e?0:e.length;return n?e[n-1]:t}var Ks=Kr(Ys);function Ys(t,e){return t&&t.length&&e&&e.length?Qr(t,e):t}var Zs=rs(function(t,e){var n=null==t?0:t.length,r=ar(t,e);return Xr(t,Oe(e,function(t){return _s(t,n)?+t:t}).sort(Mi)),r});function to(t){return null==t?t:kn.call(t)}var eo=Kr(function(t){return ci(vr(t,1,Xo,!0))}),no=Kr(function(e){var n=Js(e);return Xo(n)&&(n=t),ci(vr(e,1,Xo,!0),us(n,2))}),ro=Kr(function(e){var n=Js(e);return n="function"==typeof n?n:t,ci(vr(e,1,Xo,!0),t,n)});function io(t){if(!t||!t.length)return[];var e=0;return t=Re(t,function(t){if(Xo(t))return e=_n(t.length,e),!0}),Je(e,function(e){return Oe(t,Fe(e))})}function so(e,n){if(!e||!e.length)return[];var r=io(e);return null==n?r:Oe(r,function(e){return Ie(n,t,e)})}var oo=Kr(function(t,e){return Xo(t)?hr(t,e):[]}),ao=Kr(function(t){return mi(Re(t,Xo))}),lo=Kr(function(e){var n=Js(e);return Xo(n)&&(n=t),mi(Re(e,Xo),us(n,2))}),uo=Kr(function(e){var n=Js(e);return n="function"==typeof n?n:t,mi(Re(e,Xo),t,n)}),co=Kr(io),ho=Kr(function(e){var n=e.length,r=n>1?e[n-1]:t;return r="function"==typeof r?(e.pop(),r):t,so(e,r)});function fo(t){var e=qn(t);return e.__chain__=!0,e}function po(t,e){return e(t)}var go=rs(function(e){var n=e.length,r=n?e[0]:0,i=this.__wrapped__,s=function(t){return ar(t,e)};return!(n>1||this.__actions__.length)&&i instanceof Hn&&_s(r)?((i=i.slice(r,+r+(n?1:0))).__actions__.push({func:po,args:[s],thisArg:t}),new Wn(i,this.__chain__).thru(function(e){return n&&!e.length&&e.push(t),e})):this.thru(s)}),mo=Si(function(t,e,n){Bt.call(t,n)?++t[n]:or(t,n,1)}),yo=Ni($s),vo=Ni(Ws);function _o(t,e){return(Ho(t)?Ce:fr)(t,us(e,3))}function wo(t,e){return(Ho(t)?je:pr)(t,us(e,3))}var Ao=Si(function(t,e,n){Bt.call(t,n)?t[n].push(e):or(t,n,[e])}),bo=Kr(function(t,e,n){var r=-1,i="function"==typeof e,s=Qo(t)?bt(t.length):[];return fr(t,function(t){s[++r]=i?Ie(e,t,n):Rr(t,e,n)}),s}),Po=Si(function(t,e,n){or(t,n,e)});function ko(t,e){return(Ho(t)?Oe:Vr)(t,us(e,3))}var Eo=Si(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),Io=Kr(function(t,e){if(null==t)return[];var n=e.length;return n>1&&ws(t,e[0],e[1])?e=[]:n>2&&ws(e[0],e[1],e[2])&&(e=[e[0]]),Hr(t,vr(e,1),[])}),Mo=he||function(){return pe.Date.now()};function Co(e,n,r){return n=r?t:n,n=e&&null==n?e.length:n,Yi(e,a,t,t,t,t,n)}function jo(n,r){var i;if("function"!=typeof r)throw new xt(e);return n=ga(n),function(){return--n>0&&(i=r.apply(this,arguments)),n<=1&&(r=t),i}}var xo=Kr(function(t,e,n){var r=1;if(n.length){var i=dn(n,ls(xo));r|=s}return Yi(t,r,e,n,i)}),Ro=Kr(function(t,e,n){var r=3;if(n.length){var i=dn(n,ls(Ro));r|=s}return Yi(e,r,t,n,i)});function So(n,r,i){var s,o,a,l,u,d,c=0,h=!1,f=!1,p=!0;if("function"!=typeof n)throw new xt(e);function g(e){var r=s,i=o;return s=o=t,c=e,l=n.apply(i,r)}function m(e){var n=e-d;return d===t||n>=r||n<0||f&&e-c>=a}function y(){var t=Mo();if(m(t))return v(t);u=Rs(y,function(t){var e=r-(t-d);return f?wn(e,a-(t-c)):e}(t))}function v(e){return u=t,p&&s?g(e):(s=o=t,l)}function _(){var e=Mo(),n=m(e);if(s=arguments,o=this,d=e,n){if(u===t)return function(t){return c=t,u=Rs(y,r),h?g(t):l}(d);if(f)return Pi(u),u=Rs(y,r),g(d)}return u===t&&(u=Rs(y,r)),l}return r=ya(r)||0,ea(i)&&(h=!!i.leading,a=(f="maxWait"in i)?_n(ya(i.maxWait)||0,r):a,p="trailing"in i?!!i.trailing:p),_.cancel=function(){u!==t&&Pi(u),c=0,s=d=o=u=t},_.flush=function(){return u===t?l:v(Mo())},_}var To=Kr(function(t,e){return cr(t,1,e)}),Oo=Kr(function(t,e,n){return cr(t,ya(e)||0,n)});function Lo(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new xt(e);var r=function(){var e=arguments,i=n?n.apply(this,e):e[0],s=r.cache;if(s.has(i))return s.get(i);var o=t.apply(this,e);return r.cache=s.set(i,o)||s,o};return r.cache=new(Lo.Cache||Xn),r}function Bo(t){if("function"!=typeof t)throw new xt(e);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Lo.Cache=Xn;var Do=Ai(function(t,e){var n=(e=1==e.length&&Ho(e[0])?Oe(e[0],Ye(us())):Oe(vr(e,1),Ye(us()))).length;return Kr(function(r){for(var i=-1,s=wn(r.length,n);++i<s;)r[i]=e[i].call(this,r[i]);return Ie(t,this,r)})}),Uo=Kr(function(e,n){var r=dn(n,ls(Uo));return Yi(e,s,t,n,r)}),No=Kr(function(e,n){var r=dn(n,ls(No));return Yi(e,o,t,n,r)}),Vo=rs(function(e,n){return Yi(e,l,t,t,t,n)});function qo(t,e){return t===e||t!=t&&e!=e}var zo=Qi(Mr),$o=Qi(function(t,e){return t>=e}),Wo=Sr(function(){return arguments}())?Sr:function(t){return na(t)&&Bt.call(t,"callee")&&!Gt.call(t,"callee")},Ho=bt.isArray,Fo=we?Ye(we):function(t){return na(t)&&Ir(t)==x};function Qo(t){return null!=t&&ta(t.length)&&!Yo(t)}function Xo(t){return na(t)&&Qo(t)}var Go=_e||yl,Jo=Ae?Ye(Ae):function(t){return na(t)&&Ir(t)==y};function Ko(t){if(!na(t))return!1;var e=Ir(t);return e==v||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!sa(t)}function Yo(t){if(!ea(t))return!1;var e=Ir(t);return e==_||e==w||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Zo(t){return"number"==typeof t&&t==ga(t)}function ta(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=d}function ea(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function na(t){return null!=t&&"object"==typeof t}var ra=be?Ye(be):function(t){return na(t)&&gs(t)==A};function ia(t){return"number"==typeof t||na(t)&&Ir(t)==b}function sa(t){if(!na(t)||Ir(t)!=P)return!1;var e=Qt(t);if(null===e)return!0;var n=Bt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Lt.call(n)==Vt}var oa=Pe?Ye(Pe):function(t){return na(t)&&Ir(t)==E},aa=ke?Ye(ke):function(t){return na(t)&&gs(t)==I};function la(t){return"string"==typeof t||!Ho(t)&&na(t)&&Ir(t)==M}function ua(t){return"symbol"==typeof t||na(t)&&Ir(t)==C}var da=Ee?Ye(Ee):function(t){return na(t)&&ta(t.length)&&!!ae[Ir(t)]},ca=Qi(Nr),ha=Qi(function(t,e){return t<=e});function fa(t){if(!t)return[];if(Qo(t))return la(t)?pn(t):xi(t);if(Yt&&t[Yt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Yt]());var e=gs(t);return(e==A?ln:e==I?cn:qa)(t)}function pa(t){return t?(t=ya(t))===u||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ga(t){var e=pa(t),n=e%1;return e==e?n?e-n:e:0}function ma(t){return t?lr(ga(t),0,h):0}function ya(t){if("number"==typeof t)return t;if(ua(t))return c;if(ea(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ea(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ke(t);var n=ft.test(t);return n||gt.test(t)?ce(t.slice(2),n?2:8):ht.test(t)?c:+t}function va(t){return Ri(t,Ta(t))}function _a(t){return null==t?"":di(t)}var wa=Ti(function(t,e){if(ks(e)||Qo(e))Ri(e,Sa(e),t);else for(var n in e)Bt.call(e,n)&&nr(t,n,e[n])}),Aa=Ti(function(t,e){Ri(e,Ta(e),t)}),ba=Ti(function(t,e,n,r){Ri(e,Ta(e),t,r)}),Pa=Ti(function(t,e,n,r){Ri(e,Sa(e),t,r)}),ka=rs(ar),Ea=Kr(function(e,n){e=Mt(e);var r=-1,i=n.length,s=i>2?n[2]:t;for(s&&ws(n[0],n[1],s)&&(i=1);++r<i;)for(var o=n[r],a=Ta(o),l=-1,u=a.length;++l<u;){var d=a[l],c=e[d];(c===t||qo(c,Tt[d])&&!Bt.call(e,d))&&(e[d]=o[d])}return e}),Ia=Kr(function(e){return e.push(t,ts),Ie(La,t,e)});function Ma(e,n,r){var i=null==e?t:kr(e,n);return i===t?r:i}function Ca(t,e){return null!=t&&ms(t,e,jr)}var ja=zi(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Nt.call(e)),t[e]=n},el(il)),xa=zi(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Nt.call(e)),Bt.call(t,e)?t[e].push(n):t[e]=[n]},us),Ra=Kr(Rr);function Sa(t){return Qo(t)?Kn(t):Dr(t)}function Ta(t){return Qo(t)?Kn(t,!0):Ur(t)}var Oa=Ti(function(t,e,n){$r(t,e,n)}),La=Ti(function(t,e,n,r){$r(t,e,n,r)}),Ba=rs(function(t,e){var n={};if(null==t)return n;var r=!1;e=Oe(e,function(e){return e=wi(e,t),r||(r=e.length>1),e}),Ri(t,ss(t),n),r&&(n=ur(n,7,es));for(var i=e.length;i--;)hi(n,e[i]);return n}),Da=rs(function(t,e){return null==t?{}:function(t,e){return Fr(t,e,function(e,n){return Ca(t,n)})}(t,e)});function Ua(t,e){if(null==t)return{};var n=Oe(ss(t),function(t){return[t]});return e=us(e),Fr(t,n,function(t,n){return e(t,n[0])})}var Na=Ki(Sa),Va=Ki(Ta);function qa(t){return null==t?[]:Ze(t,Sa(t))}var za=Di(function(t,e,n){return e=e.toLowerCase(),t+(n?$a(e):e)});function $a(t){return Ka(_a(t).toLowerCase())}function Wa(t){return(t=_a(t))&&t.replace(yt,rn).replace(te,"")}var Ha=Di(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Fa=Di(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),Qa=Bi("toLowerCase"),Xa=Di(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Ga=Di(function(t,e,n){return t+(n?" ":"")+Ka(e)}),Ja=Di(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Ka=Bi("toUpperCase");function Ya(e,n,r){return e=_a(e),(n=r?t:n)===t?function(t){return ie.test(t)}(e)?function(t){return t.match(ne)||[]}(e):function(t){return t.match(at)||[]}(e):e.match(n)||[]}var Za=Kr(function(e,n){try{return Ie(e,t,n)}catch(t){return Ko(t)?t:new kt(t)}}),tl=rs(function(t,e){return Ce(e,function(e){e=Ds(e),or(t,e,xo(t[e],t))}),t});function el(t){return function(){return t}}var nl=Vi(),rl=Vi(!0);function il(t){return t}function sl(t){return Br("function"==typeof t?t:ur(t,1))}var ol=Kr(function(t,e){return function(n){return Rr(n,t,e)}}),al=Kr(function(t,e){return function(n){return Rr(t,n,e)}});function ll(t,e,n){var r=Sa(e),i=Pr(e,r);null!=n||ea(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=Pr(e,Sa(e)));var s=!(ea(n)&&"chain"in n&&!n.chain),o=Yo(t);return Ce(i,function(n){var r=e[n];t[n]=r,o&&(t.prototype[n]=function(){var e=this.__chain__;if(s||e){var n=t(this.__wrapped__);return(n.__actions__=xi(this.__actions__)).push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Le([this.value()],arguments))})}),t}function ul(){}var dl=Wi(Oe),cl=Wi(xe),hl=Wi(Ue);function fl(t){return As(t)?Fe(Ds(t)):function(t){return function(e){return kr(e,t)}}(t)}var pl=Fi(),gl=Fi(!0);function ml(){return[]}function yl(){return!1}var vl,_l=$i(function(t,e){return t+e},0),wl=Gi("ceil"),Al=$i(function(t,e){return t/e},1),bl=Gi("floor"),Pl=$i(function(t,e){return t*e},1),kl=Gi("round"),El=$i(function(t,e){return t-e},0);return qn.after=function(t,n){if("function"!=typeof n)throw new xt(e);return t=ga(t),function(){if(--t<1)return n.apply(this,arguments)}},qn.ary=Co,qn.assign=wa,qn.assignIn=Aa,qn.assignInWith=ba,qn.assignWith=Pa,qn.at=ka,qn.before=jo,qn.bind=xo,qn.bindAll=tl,qn.bindKey=Ro,qn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ho(t)?t:[t]},qn.chain=fo,qn.chunk=function(e,n,r){n=(r?ws(e,n,r):n===t)?1:_n(ga(n),0);var i=null==e?0:e.length;if(!i||n<1)return[];for(var s=0,o=0,a=bt(ge(i/n));s<i;)a[o++]=ii(e,s,s+=n);return a},qn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var s=t[e];s&&(i[r++]=s)}return i},qn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=bt(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return Le(Ho(n)?xi(n):[n],vr(e,1))},qn.cond=function(t){var n=null==t?0:t.length,r=us();return t=n?Oe(t,function(t){if("function"!=typeof t[1])throw new xt(e);return[r(t[0]),t[1]]}):[],Kr(function(e){for(var r=-1;++r<n;){var i=t[r];if(Ie(i[0],this,e))return Ie(i[1],this,e)}})},qn.conforms=function(t){return function(t){var e=Sa(t);return function(n){return dr(n,t,e)}}(ur(t,1))},qn.constant=el,qn.countBy=mo,qn.create=function(t,e){var n=zn(t);return null==e?n:sr(n,e)},qn.curry=function e(n,r,i){var s=Yi(n,8,t,t,t,t,t,r=i?t:r);return s.placeholder=e.placeholder,s},qn.curryRight=function e(n,r,s){var o=Yi(n,i,t,t,t,t,t,r=s?t:r);return o.placeholder=e.placeholder,o},qn.debounce=So,qn.defaults=Ea,qn.defaultsDeep=Ia,qn.defer=To,qn.delay=Oo,qn.difference=Vs,qn.differenceBy=qs,qn.differenceWith=zs,qn.drop=function(e,n,r){var i=null==e?0:e.length;return i?ii(e,(n=r||n===t?1:ga(n))<0?0:n,i):[]},qn.dropRight=function(e,n,r){var i=null==e?0:e.length;return i?ii(e,0,(n=i-(n=r||n===t?1:ga(n)))<0?0:n):[]},qn.dropRightWhile=function(t,e){return t&&t.length?pi(t,us(e,3),!0,!0):[]},qn.dropWhile=function(t,e){return t&&t.length?pi(t,us(e,3),!0):[]},qn.fill=function(e,n,r,i){var s=null==e?0:e.length;return s?(r&&"number"!=typeof r&&ws(e,n,r)&&(r=0,i=s),function(e,n,r,i){var s=e.length;for((r=ga(r))<0&&(r=-r>s?0:s+r),(i=i===t||i>s?s:ga(i))<0&&(i+=s),i=r>i?0:ma(i);r<i;)e[r++]=n;return e}(e,n,r,i)):[]},qn.filter=function(t,e){return(Ho(t)?Re:yr)(t,us(e,3))},qn.flatMap=function(t,e){return vr(ko(t,e),1)},qn.flatMapDeep=function(t,e){return vr(ko(t,e),u)},qn.flatMapDepth=function(e,n,r){return r=r===t?1:ga(r),vr(ko(e,n),r)},qn.flatten=Hs,qn.flattenDeep=function(t){return null!=t&&t.length?vr(t,u):[]},qn.flattenDepth=function(e,n){return null!=e&&e.length?vr(e,n=n===t?1:ga(n)):[]},qn.flip=function(t){return Yi(t,512)},qn.flow=nl,qn.flowRight=rl,qn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},qn.functions=function(t){return null==t?[]:Pr(t,Sa(t))},qn.functionsIn=function(t){return null==t?[]:Pr(t,Ta(t))},qn.groupBy=Ao,qn.initial=function(t){return null!=t&&t.length?ii(t,0,-1):[]},qn.intersection=Qs,qn.intersectionBy=Xs,qn.intersectionWith=Gs,qn.invert=ja,qn.invertBy=xa,qn.invokeMap=bo,qn.iteratee=sl,qn.keyBy=Po,qn.keys=Sa,qn.keysIn=Ta,qn.map=ko,qn.mapKeys=function(t,e){var n={};return e=us(e,3),Ar(t,function(t,r,i){or(n,e(t,r,i),t)}),n},qn.mapValues=function(t,e){var n={};return e=us(e,3),Ar(t,function(t,r,i){or(n,r,e(t,r,i))}),n},qn.matches=function(t){return qr(ur(t,1))},qn.matchesProperty=function(t,e){return zr(t,ur(e,1))},qn.memoize=Lo,qn.merge=Oa,qn.mergeWith=La,qn.method=ol,qn.methodOf=al,qn.mixin=ll,qn.negate=Bo,qn.nthArg=function(t){return t=ga(t),Kr(function(e){return Wr(e,t)})},qn.omit=Ba,qn.omitBy=function(t,e){return Ua(t,Bo(us(e)))},qn.once=function(t){return jo(2,t)},qn.orderBy=function(e,n,r,i){return null==e?[]:(Ho(n)||(n=null==n?[]:[n]),Ho(r=i?t:r)||(r=null==r?[]:[r]),Hr(e,n,r))},qn.over=dl,qn.overArgs=Do,qn.overEvery=cl,qn.overSome=hl,qn.partial=Uo,qn.partialRight=No,qn.partition=Eo,qn.pick=Da,qn.pickBy=Ua,qn.property=fl,qn.propertyOf=function(e){return function(n){return null==e?t:kr(e,n)}},qn.pull=Ks,qn.pullAll=Ys,qn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Qr(t,e,us(n,2)):t},qn.pullAllWith=function(e,n,r){return e&&e.length&&n&&n.length?Qr(e,n,t,r):e},qn.pullAt=Zs,qn.range=pl,qn.rangeRight=gl,qn.rearg=Vo,qn.reject=function(t,e){return(Ho(t)?Re:yr)(t,Bo(us(e,3)))},qn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],s=t.length;for(e=us(e,3);++r<s;){var o=t[r];e(o,r,t)&&(n.push(o),i.push(r))}return Xr(t,i),n},qn.rest=function(n,r){if("function"!=typeof n)throw new xt(e);return Kr(n,r=r===t?r:ga(r))},qn.reverse=to,qn.sampleSize=function(e,n,r){return n=(r?ws(e,n,r):n===t)?1:ga(n),(Ho(e)?Zn:Zr)(e,n)},qn.set=function(t,e,n){return null==t?t:ti(t,e,n)},qn.setWith=function(e,n,r,i){return i="function"==typeof i?i:t,null==e?e:ti(e,n,r,i)},qn.shuffle=function(t){return(Ho(t)?tr:ri)(t)},qn.slice=function(e,n,r){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&ws(e,n,r)?(n=0,r=i):(n=null==n?0:ga(n),r=r===t?i:ga(r)),ii(e,n,r)):[]},qn.sortBy=Io,qn.sortedUniq=function(t){return t&&t.length?li(t):[]},qn.sortedUniqBy=function(t,e){return t&&t.length?li(t,us(e,2)):[]},qn.split=function(e,n,r){return r&&"number"!=typeof r&&ws(e,n,r)&&(n=r=t),(r=r===t?h:r>>>0)?(e=_a(e))&&("string"==typeof n||null!=n&&!oa(n))&&!(n=di(n))&&an(e)?bi(pn(e),0,r):e.split(n,r):[]},qn.spread=function(t,n){if("function"!=typeof t)throw new xt(e);return n=null==n?0:_n(ga(n),0),Kr(function(e){var r=e[n],i=bi(e,0,n);return r&&Le(i,r),Ie(t,this,i)})},qn.tail=function(t){var e=null==t?0:t.length;return e?ii(t,1,e):[]},qn.take=function(e,n,r){return e&&e.length?ii(e,0,(n=r||n===t?1:ga(n))<0?0:n):[]},qn.takeRight=function(e,n,r){var i=null==e?0:e.length;return i?ii(e,(n=i-(n=r||n===t?1:ga(n)))<0?0:n,i):[]},qn.takeRightWhile=function(t,e){return t&&t.length?pi(t,us(e,3),!1,!0):[]},qn.takeWhile=function(t,e){return t&&t.length?pi(t,us(e,3)):[]},qn.tap=function(t,e){return e(t),t},qn.throttle=function(t,n,r){var i=!0,s=!0;if("function"!=typeof t)throw new xt(e);return ea(r)&&(i="leading"in r?!!r.leading:i,s="trailing"in r?!!r.trailing:s),So(t,n,{leading:i,maxWait:n,trailing:s})},qn.thru=po,qn.toArray=fa,qn.toPairs=Na,qn.toPairsIn=Va,qn.toPath=function(t){return Ho(t)?Oe(t,Ds):ua(t)?[t]:xi(Bs(_a(t)))},qn.toPlainObject=va,qn.transform=function(t,e,n){var r=Ho(t),i=r||Go(t)||da(t);if(e=us(e,4),null==n){var s=t&&t.constructor;n=i?r?new s:[]:ea(t)&&Yo(s)?zn(Qt(t)):{}}return(i?Ce:Ar)(t,function(t,r,i){return e(n,t,r,i)}),n},qn.unary=function(t){return Co(t,1)},qn.union=eo,qn.unionBy=no,qn.unionWith=ro,qn.uniq=function(t){return t&&t.length?ci(t):[]},qn.uniqBy=function(t,e){return t&&t.length?ci(t,us(e,2)):[]},qn.uniqWith=function(e,n){return n="function"==typeof n?n:t,e&&e.length?ci(e,t,n):[]},qn.unset=function(t,e){return null==t||hi(t,e)},qn.unzip=io,qn.unzipWith=so,qn.update=function(t,e,n){return null==t?t:fi(t,e,_i(n))},qn.updateWith=function(e,n,r,i){return i="function"==typeof i?i:t,null==e?e:fi(e,n,_i(r),i)},qn.values=qa,qn.valuesIn=function(t){return null==t?[]:Ze(t,Ta(t))},qn.without=oo,qn.words=Ya,qn.wrap=function(t,e){return Uo(_i(e),t)},qn.xor=ao,qn.xorBy=lo,qn.xorWith=uo,qn.zip=co,qn.zipObject=function(t,e){return yi(t||[],e||[],nr)},qn.zipObjectDeep=function(t,e){return yi(t||[],e||[],ti)},qn.zipWith=ho,qn.entries=Na,qn.entriesIn=Va,qn.extend=Aa,qn.extendWith=ba,ll(qn,qn),qn.add=_l,qn.attempt=Za,qn.camelCase=za,qn.capitalize=$a,qn.ceil=wl,qn.clamp=function(e,n,r){return r===t&&(r=n,n=t),r!==t&&(r=(r=ya(r))==r?r:0),n!==t&&(n=(n=ya(n))==n?n:0),lr(ya(e),n,r)},qn.clone=function(t){return ur(t,4)},qn.cloneDeep=function(t){return ur(t,5)},qn.cloneDeepWith=function(e,n){return ur(e,5,n="function"==typeof n?n:t)},qn.cloneWith=function(e,n){return ur(e,4,n="function"==typeof n?n:t)},qn.conformsTo=function(t,e){return null==e||dr(t,e,Sa(e))},qn.deburr=Wa,qn.defaultTo=function(t,e){return null==t||t!=t?e:t},qn.divide=Al,qn.endsWith=function(e,n,r){e=_a(e),n=di(n);var i=e.length,s=r=r===t?i:lr(ga(r),0,i);return(r-=n.length)>=0&&e.slice(r,s)==n},qn.eq=qo,qn.escape=function(t){return(t=_a(t))&&Q.test(t)?t.replace(H,sn):t},qn.escapeRegExp=function(t){return(t=_a(t))&&et.test(t)?t.replace(tt,"\\$&"):t},qn.every=function(e,n,r){var i=Ho(e)?xe:gr;return r&&ws(e,n,r)&&(n=t),i(e,us(n,3))},qn.find=yo,qn.findIndex=$s,qn.findKey=function(t,e){return Ve(t,us(e,3),Ar)},qn.findLast=vo,qn.findLastIndex=Ws,qn.findLastKey=function(t,e){return Ve(t,us(e,3),br)},qn.floor=bl,qn.forEach=_o,qn.forEachRight=wo,qn.forIn=function(t,e){return null==t?t:_r(t,us(e,3),Ta)},qn.forInRight=function(t,e){return null==t?t:wr(t,us(e,3),Ta)},qn.forOwn=function(t,e){return t&&Ar(t,us(e,3))},qn.forOwnRight=function(t,e){return t&&br(t,us(e,3))},qn.get=Ma,qn.gt=zo,qn.gte=$o,qn.has=function(t,e){return null!=t&&ms(t,e,Cr)},qn.hasIn=Ca,qn.head=Fs,qn.identity=il,qn.includes=function(t,e,n,r){t=Qo(t)?t:qa(t),n=n&&!r?ga(n):0;var i=t.length;return n<0&&(n=_n(i+n,0)),la(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&ze(t,e,n)>-1},qn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ga(n);return i<0&&(i=_n(r+i,0)),ze(t,e,i)},qn.inRange=function(e,n,r){return n=pa(n),r===t?(r=n,n=0):r=pa(r),function(t,e,n){return t>=wn(e,n)&&t<_n(e,n)}(e=ya(e),n,r)},qn.invoke=Ra,qn.isArguments=Wo,qn.isArray=Ho,qn.isArrayBuffer=Fo,qn.isArrayLike=Qo,qn.isArrayLikeObject=Xo,qn.isBoolean=function(t){return!0===t||!1===t||na(t)&&Ir(t)==m},qn.isBuffer=Go,qn.isDate=Jo,qn.isElement=function(t){return na(t)&&1===t.nodeType&&!sa(t)},qn.isEmpty=function(t){if(null==t)return!0;if(Qo(t)&&(Ho(t)||"string"==typeof t||"function"==typeof t.splice||Go(t)||da(t)||Wo(t)))return!t.length;var e=gs(t);if(e==A||e==I)return!t.size;if(ks(t))return!Dr(t).length;for(var n in t)if(Bt.call(t,n))return!1;return!0},qn.isEqual=function(t,e){return Tr(t,e)},qn.isEqualWith=function(e,n,r){var i=(r="function"==typeof r?r:t)?r(e,n):t;return i===t?Tr(e,n,t,r):!!i},qn.isError=Ko,qn.isFinite=function(t){return"number"==typeof t&&Ne(t)},qn.isFunction=Yo,qn.isInteger=Zo,qn.isLength=ta,qn.isMap=ra,qn.isMatch=function(t,e){return t===e||Or(t,e,cs(e))},qn.isMatchWith=function(e,n,r){return r="function"==typeof r?r:t,Or(e,n,cs(n),r)},qn.isNaN=function(t){return ia(t)&&t!=+t},qn.isNative=function(t){if(Ps(t))throw new kt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Lr(t)},qn.isNil=function(t){return null==t},qn.isNull=function(t){return null===t},qn.isNumber=ia,qn.isObject=ea,qn.isObjectLike=na,qn.isPlainObject=sa,qn.isRegExp=oa,qn.isSafeInteger=function(t){return Zo(t)&&t>=-9007199254740991&&t<=d},qn.isSet=aa,qn.isString=la,qn.isSymbol=ua,qn.isTypedArray=da,qn.isUndefined=function(e){return e===t},qn.isWeakMap=function(t){return na(t)&&gs(t)==j},qn.isWeakSet=function(t){return na(t)&&"[object WeakSet]"==Ir(t)},qn.join=function(t,e){return null==t?"":Qe.call(t,e)},qn.kebabCase=Ha,qn.last=Js,qn.lastIndexOf=function(e,n,r){var i=null==e?0:e.length;if(!i)return-1;var s=i;return r!==t&&(s=(s=ga(r))<0?_n(i+s,0):wn(s,i-1)),n==n?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(e,n,s):qe(e,We,s,!0)},qn.lowerCase=Fa,qn.lowerFirst=Qa,qn.lt=ca,qn.lte=ha,qn.max=function(e){return e&&e.length?mr(e,il,Mr):t},qn.maxBy=function(e,n){return e&&e.length?mr(e,us(n,2),Mr):t},qn.mean=function(t){return He(t,il)},qn.meanBy=function(t,e){return He(t,us(e,2))},qn.min=function(e){return e&&e.length?mr(e,il,Nr):t},qn.minBy=function(e,n){return e&&e.length?mr(e,us(n,2),Nr):t},qn.stubArray=ml,qn.stubFalse=yl,qn.stubObject=function(){return{}},qn.stubString=function(){return""},qn.stubTrue=function(){return!0},qn.multiply=Pl,qn.nth=function(e,n){return e&&e.length?Wr(e,ga(n)):t},qn.noConflict=function(){return pe._===this&&(pe._=qt),this},qn.noop=ul,qn.now=Mo,qn.pad=function(t,e,n){t=_a(t);var r=(e=ga(e))?fn(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Hi(me(i),n)+t+Hi(ge(i),n)},qn.padEnd=function(t,e,n){t=_a(t);var r=(e=ga(e))?fn(t):0;return e&&r<e?t+Hi(e-r,n):t},qn.padStart=function(t,e,n){t=_a(t);var r=(e=ga(e))?fn(t):0;return e&&r<e?Hi(e-r,n)+t:t},qn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),bn(_a(t).replace(nt,""),e||0)},qn.random=function(e,n,r){if(r&&"boolean"!=typeof r&&ws(e,n,r)&&(n=r=t),r===t&&("boolean"==typeof n?(r=n,n=t):"boolean"==typeof e&&(r=e,e=t)),e===t&&n===t?(e=0,n=1):(e=pa(e),n===t?(n=e,e=0):n=pa(n)),e>n){var i=e;e=n,n=i}if(r||e%1||n%1){var s=Pn();return wn(e+s*(n-e+de("1e-"+((s+"").length-1))),n)}return Gr(e,n)},qn.reduce=function(t,e,n){var r=Ho(t)?Be:Xe,i=arguments.length<3;return r(t,us(e,4),n,i,fr)},qn.reduceRight=function(t,e,n){var r=Ho(t)?De:Xe,i=arguments.length<3;return r(t,us(e,4),n,i,pr)},qn.repeat=function(e,n,r){return n=(r?ws(e,n,r):n===t)?1:ga(n),Jr(_a(e),n)},qn.replace=function(){var t=arguments,e=_a(t[0]);return t.length<3?e:e.replace(t[1],t[2])},qn.result=function(e,n,r){var i=-1,s=(n=wi(n,e)).length;for(s||(s=1,e=t);++i<s;){var o=null==e?t:e[Ds(n[i])];o===t&&(i=s,o=r),e=Yo(o)?o.call(e):o}return e},qn.round=kl,qn.runInContext=rt,qn.sample=function(t){return(Ho(t)?Yn:Yr)(t)},qn.size=function(t){if(null==t)return 0;if(Qo(t))return la(t)?fn(t):t.length;var e=gs(t);return e==A||e==I?t.size:Dr(t).length},qn.snakeCase=Xa,qn.some=function(e,n,r){var i=Ho(e)?Ue:si;return r&&ws(e,n,r)&&(n=t),i(e,us(n,3))},qn.sortedIndex=function(t,e){return oi(t,e)},qn.sortedIndexBy=function(t,e,n){return ai(t,e,us(n,2))},qn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=oi(t,e);if(r<n&&qo(t[r],e))return r}return-1},qn.sortedLastIndex=function(t,e){return oi(t,e,!0)},qn.sortedLastIndexBy=function(t,e,n){return ai(t,e,us(n,2),!0)},qn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=oi(t,e,!0)-1;if(qo(t[n],e))return n}return-1},qn.startCase=Ga,qn.startsWith=function(t,e,n){return t=_a(t),n=null==n?0:lr(ga(n),0,t.length),e=di(e),t.slice(n,n+e.length)==e},qn.subtract=El,qn.sum=function(t){return t&&t.length?Ge(t,il):0},qn.sumBy=function(t,e){return t&&t.length?Ge(t,us(e,2)):0},qn.template=function(e,n,r){var i=qn.templateSettings;r&&ws(e,n,r)&&(n=t),e=_a(e),n=ba({},n,i,Zi);var s,o,a=ba({},n.imports,i.imports,Zi),l=Sa(a),u=Ze(a,l),d=0,c=n.interpolate||vt,h="__p += '",f=Ct((n.escape||vt).source+"|"+c.source+"|"+(c===J?dt:vt).source+"|"+(n.evaluate||vt).source+"|$","g"),p="//# sourceURL="+(Bt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++oe+"]")+"\n";e.replace(f,function(t,n,r,i,a,l){return r||(r=i),h+=e.slice(d,l).replace(_t,on),n&&(s=!0,h+="' +\n__e("+n+") +\n'"),a&&(o=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),d=l+t.length,t}),h+="';\n";var g=Bt.call(n,"variable")&&n.variable;if(g){if(lt.test(g))throw new kt("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(o?h.replace(q,""):h).replace(z,"$1").replace($,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=Za(function(){return Et(l,p+"return "+h).apply(t,u)});if(m.source=h,Ko(m))throw m;return m},qn.times=function(t,e){if((t=ga(t))<1||t>d)return[];var n=h,r=wn(t,h);e=us(e),t-=h;for(var i=Je(r,e);++n<t;)e(n);return i},qn.toFinite=pa,qn.toInteger=ga,qn.toLength=ma,qn.toLower=function(t){return _a(t).toLowerCase()},qn.toNumber=ya,qn.toSafeInteger=function(t){return t?lr(ga(t),-9007199254740991,d):0===t?t:0},qn.toString=_a,qn.toUpper=function(t){return _a(t).toUpperCase()},qn.trim=function(e,n,r){if((e=_a(e))&&(r||n===t))return Ke(e);if(!e||!(n=di(n)))return e;var i=pn(e),s=pn(n);return bi(i,en(i,s),nn(i,s)+1).join("")},qn.trimEnd=function(e,n,r){if((e=_a(e))&&(r||n===t))return e.slice(0,gn(e)+1);if(!e||!(n=di(n)))return e;var i=pn(e);return bi(i,0,nn(i,pn(n))+1).join("")},qn.trimStart=function(e,n,r){if((e=_a(e))&&(r||n===t))return e.replace(nt,"");if(!e||!(n=di(n)))return e;var i=pn(e);return bi(i,en(i,pn(n))).join("")},qn.truncate=function(e,n){var r=30,i="...";if(ea(n)){var s="separator"in n?n.separator:s;r="length"in n?ga(n.length):r,i="omission"in n?di(n.omission):i}var o=(e=_a(e)).length;if(an(e)){var a=pn(e);o=a.length}if(r>=o)return e;var l=r-fn(i);if(l<1)return i;var u=a?bi(a,0,l).join(""):e.slice(0,l);if(s===t)return u+i;if(a&&(l+=u.length-l),oa(s)){if(e.slice(l).search(s)){var d,c=u;for(s.global||(s=Ct(s.source,_a(ct.exec(s))+"g")),s.lastIndex=0;d=s.exec(c);)var h=d.index;u=u.slice(0,h===t?l:h)}}else if(e.indexOf(di(s),l)!=l){var f=u.lastIndexOf(s);f>-1&&(u=u.slice(0,f))}return u+i},qn.unescape=function(t){return(t=_a(t))&&F.test(t)?t.replace(W,mn):t},qn.uniqueId=function(t){var e=++Dt;return _a(t)+e},qn.upperCase=Ja,qn.upperFirst=Ka,qn.each=_o,qn.eachRight=wo,qn.first=Fs,ll(qn,(vl={},Ar(qn,function(t,e){Bt.call(qn.prototype,e)||(vl[e]=t)}),vl),{chain:!1}),qn.VERSION="4.17.21",Ce(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){qn[t].placeholder=qn}),Ce(["drop","take"],function(e,n){Hn.prototype[e]=function(r){r=r===t?1:_n(ga(r),0);var i=this.__filtered__&&!n?new Hn(this):this.clone();return i.__filtered__?i.__takeCount__=wn(r,i.__takeCount__):i.__views__.push({size:wn(r,h),type:e+(i.__dir__<0?"Right":"")}),i},Hn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Ce(["filter","map","takeWhile"],function(t,e){var n=e+1,r=1==n||3==n;Hn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:us(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),Ce(["head","last"],function(t,e){var n="take"+(e?"Right":"");Hn.prototype[t]=function(){return this[n](1).value()[0]}}),Ce(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");Hn.prototype[t]=function(){return this.__filtered__?new Hn(this):this[n](1)}}),Hn.prototype.compact=function(){return this.filter(il)},Hn.prototype.find=function(t){return this.filter(t).head()},Hn.prototype.findLast=function(t){return this.reverse().find(t)},Hn.prototype.invokeMap=Kr(function(t,e){return"function"==typeof t?new Hn(this):this.map(function(n){return Rr(n,t,e)})}),Hn.prototype.reject=function(t){return this.filter(Bo(us(t)))},Hn.prototype.slice=function(e,n){e=ga(e);var r=this;return r.__filtered__&&(e>0||n<0)?new Hn(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),n!==t&&(r=(n=ga(n))<0?r.dropRight(-n):r.take(n-e)),r)},Hn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Hn.prototype.toArray=function(){return this.take(h)},Ar(Hn.prototype,function(e,n){var r=/^(?:filter|find|map|reject)|While$/.test(n),i=/^(?:head|last)$/.test(n),s=qn[i?"take"+("last"==n?"Right":""):n],o=i||/^find/.test(n);s&&(qn.prototype[n]=function(){var n=this.__wrapped__,a=i?[1]:arguments,l=n instanceof Hn,u=a[0],d=l||Ho(n),c=function(t){var e=s.apply(qn,Le([t],a));return i&&h?e[0]:e};d&&r&&"function"==typeof u&&1!=u.length&&(l=d=!1);var h=this.__chain__,f=!!this.__actions__.length,p=o&&!h,g=l&&!f;if(!o&&d){n=g?n:new Hn(this);var m=e.apply(n,a);return m.__actions__.push({func:po,args:[c],thisArg:t}),new Wn(m,h)}return p&&g?e.apply(this,a):(m=this.thru(c),p?i?m.value()[0]:m.value():m)})}),Ce(["pop","push","shift","sort","splice","unshift"],function(t){var e=Rt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);qn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Ho(i)?i:[],t)}return this[n](function(n){return e.apply(Ho(n)?n:[],t)})}}),Ar(Hn.prototype,function(t,e){var n=qn[e];if(n){var r=n.name+"";Bt.call(Sn,r)||(Sn[r]=[]),Sn[r].push({name:e,func:n})}}),Sn[qi(t,2).name]=[{name:"wrapper",func:t}],Hn.prototype.clone=function(){var t=new Hn(this.__wrapped__);return t.__actions__=xi(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=xi(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=xi(this.__views__),t},Hn.prototype.reverse=function(){if(this.__filtered__){var t=new Hn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Hn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ho(t),r=e<0,i=n?t.length:0,s=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var s=n[r],o=s.size;switch(s.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=wn(e,t+o);break;case"takeRight":t=_n(t,e-o)}}return{start:t,end:e}}(0,i,this.__views__),o=s.start,a=s.end,l=a-o,u=r?a:o-1,d=this.__iteratees__,c=d.length,h=0,f=wn(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return gi(t,this.__actions__);var p=[];t:for(;l--&&h<f;){for(var g=-1,m=t[u+=e];++g<c;){var y=d[g],v=y.iteratee,_=y.type,w=v(m);if(2==_)m=w;else if(!w){if(1==_)continue t;break t}}p[h++]=m}return p},qn.prototype.at=go,qn.prototype.chain=function(){return fo(this)},qn.prototype.commit=function(){return new Wn(this.value(),this.__chain__)},qn.prototype.next=function(){this.__values__===t&&(this.__values__=fa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?t:this.__values__[this.__index__++]}},qn.prototype.plant=function(e){for(var n,r=this;r instanceof $n;){var i=Ns(r);i.__index__=0,i.__values__=t,n?s.__wrapped__=i:n=i;var s=i;r=r.__wrapped__}return s.__wrapped__=e,n},qn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Hn){var n=e;return this.__actions__.length&&(n=new Hn(this)),(n=n.reverse()).__actions__.push({func:po,args:[to],thisArg:t}),new Wn(n,this.__chain__)}return this.thru(to)},qn.prototype.toJSON=qn.prototype.valueOf=qn.prototype.value=function(){return gi(this.__wrapped__,this.__actions__)},qn.prototype.first=qn.prototype.head,Yt&&(qn.prototype[Yt]=function(){return this}),qn}();me?((me.exports=yn)._=yn,ge._=yn):pe._=yn}.call(Bt);var Ut=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)};class Nt{constructor(t,e,n){this.config=t,this.setOptions(n),this.setLocalizationOptions(e)}setLocalizationOptions(t){for(const e in t)e&&"string"==typeof e&&(this[e]=t[e])}getFinalValue(t,e,n){const r=typeof n;if(void 0!==e){if("boolean"!==r&&"number"!==r||(e=(t=>{if("true"===t)return!0;if("false"===t)return!1;const e=parseFloat(t);return isNaN(e)?t:e})(e)),typeof e!==r)throw new Error(`invalid parameter: ${t} should be a ${r}`);return"object"===r&&"object"==typeof e?Dt.exports.mergeWith(n,e,(t,e)=>{if(null===e&&t)return t}):e}return n}setOptions(t,e=!1){for(const n in t)if(Ut(t,n)){const r=e?this.config[n]||this.config[n.toLowerCase()]:this.config[n],i=t[n];this[n]=this.getFinalValue(n,r,i)}}}const Vt={adPosition:"",autoplayadsmuted:!1,companiondiv:null,companionResourceType:"",customUi:null,debug:!1,omidSupport:"disabled",omidAccessModeRules:{},enablePreloading:!1,loadVideoTimeout:15e3,locale:"",maxRedirects:-1,ppid:"",preloadAds:!1,requestTimeout:1e4,truncateMacros:!0,vastLoadTimeout:1e4,vpaidcontrols:!1,vpaidmode:"insecure"};class qt extends Nt{constructor(t,e,n){var r;const i=null==e||null==(r=e.localization)?void 0:r.advertising,{admessage:s,cuetext:o,podmessage:a,loadingAd:l,skipmessage:u,skiptext:d}=i;super(t,{admessage:s,cuetext:o,podmessage:a,loadingAd:l,skipmessage:u,skiptext:d},Vt),this.utils=n,this.bidsResponse={}}}class zt{constructor(t,e,n){n.addClass(t,"jw-plugin-googima");const r=document.createElement("div");r.id=`${e}_ad`,r.className="jw-ads-view",this.visible=!1,this.utils=n,this.div=t,this.adDiv=r,t.appendChild(r)}resizeNonLinear(t){this.resize(!1,t)}resizeLinear(){this.resize(!0)}resize(t,e){const n=this.utils;n.toggleClass(this.div,"jw-ad-non-linear",!t),n.toggleClass(this.div,"jw-ad-linear",t),n.style(this.div,{height:e?`${e}px`:""})}getAdDiv(){return this.adDiv}adSetup(){this.visible=!0,this.utils.addClass(this.div,"jw-ad-instream"),this.resize(!0)}adTakeDown(){this.visible=!1,this.utils.removeClass(this.div,"jw-ad-instream"),this.resize(!0)}}const $t={};let Wt=null;function Ht(t){var e,n,r;return!Wt&&null!=(e=window)&&null!=(n=e.google)&&null!=(r=n.ima)&&r.AdDisplayContainer&&(Wt=Promise.resolve()),Wt||(Wt=function(t,e){if($t[e])return $t[e];"file:"===document.location.protocol&&0===e.indexOf("//")&&(e=`https:${e}`);const n=new(0,t.scriptloader)(e);return $t[e]=n.load(),$t[e]}(t,"//imasdk.googleapis.com/js/sdkloader/ima3.js"),Wt)}class Ft{constructor(t,e,n){t.extend(this,e),this.vol=0,this.imaProxy=null,this.view=n}setProxy(t){this.imaProxy=t,"boolean"==typeof this.muted&&this.mute(this.muted)}attachMedia(){}detachMedia(){}mute(t){this.muted=t,this.imaProxy&&(t?this.imaProxy.setVolume(0):this.vol>=0&&this.imaProxy.setVolume(this.vol)),this.muteAllAdContainerVideo(t)}muteAllAdContainerVideo(t){const e=this.view.getAdDiv().getElementsByTagName("video");for(let n=0;n<e.length;n++)e[n].muted=t}volume(t){this.vol=t/100,this.imaProxy&&this.imaProxy.setVolume(this.vol)}}class Qt{constructor(t,e,n,r,i){Object.assign(this,t.Events),this.client="shared",this.player=t,this.item=n,this.config=r,this.casting=i;const s=t.utils,o=new jt(s);this.adRules=new St(t,o.getAdRules(r)),"string"==typeof e?(this.schedule=new It(this.adRules,s),this.schedule.setPreRoll({tag:e})):(this.schedule=e,e.resetAllBreakIds()),this.logger=this.player.utils.logger.child("ads-shared/PlaylistItemManager"),this.vmapPromise=null,this.lastTimeEvent=null,this.prerollPromise=null,this.midrollPromise={},this.postrollPromise=null,this.next=null,this.nextPlaylistItemPromise=null,this.relatedNextUp=null,this.bidding=t.getPlugin("bidding"),this.bids=[],this.bidsPromises=[],this.bidsPromise=null,this._events=[]}attachListeners(){this.player.on({all:this.onAll,beforePlay:this.checkPreroll,relatedReady:this.relatedReady,cast:this.onCast,destroyBidding:this.destroyBids},this)}onAll(t,e){this.isDestroyed()||(t===a?this.checkMidrolls(e):"beforeComplete"===t?this.checkPostrolls(e):"meta"===t&&this.schedule.sort(this.player.getDuration()),"complete"===t&&(this.player.videoHasCompleted=!0))}relatedReady(){if(this.config.preloadAds){const t=this.player.getPlugin("related");t&&t.on("nextUp",t=>{t&&"discovery"===t.mode&&(this.relatedNextUp=t)})}}onCast(t){this.casting=Boolean(t.active)}init(t,e){if(this.config.clearAdsOnComplete&&this.player.videoHasCompleted&&this.schedule.clearAds(),t=t||null,this.schedule.isVMAP()&&(e.requestTimeout=this.schedule.requestTimeout,e.creativeTimeout=this.schedule.creativeTimeout,this.vmapPromise=this.schedule.load(this.player,this.item,this.client,e)),this.bidsPromise=this.vmapPromise||Promise.resolve(),this.bidsPromise=null!==t?this.bidsPromise.then(()=>{if(this.isDestroyed())return;if(this.bidding)return this.createBidsPromise(t,e);const n=function(t,e,n){const r=xt(t,e,n);return Object.assign(r,{message:"Ad Error: bidding plugin unavailable",code:900,adErrorCode:60008}),r}(this,null,e);this.player.trigger(f,n)}).catch(t=>this.logger.debug(t)):this.bidsPromise.catch(t=>this.logger.debug(t)),this.config.preloadAds)if(1===e.playlistItemEventCount){const t=this.player.getConfig().autostart;!1===t||"viewable"===t&&0===this.player.getViewable()?this.loadPreroll(e).catch(t=>this.isDestroyed()?null:this.enqueueAdEvent(f,t,{preload:!0})):this.player.once("autostartNotAllowed",()=>{this.loadPreroll(e).catch(t=>this.isDestroyed()?null:this.enqueueAdEvent(f,t,{preload:!0}))})}else e.preloadPreroll&&this.loadPreroll(e).catch(t=>this.isDestroyed()?null:this.enqueueAdEvent(f,t,{preload:!0}));return this.bidsPromise}createBidsPromise(e,n){const r=this.player;let i=parseInt(e.bidOnBreaks,10);return i=i>0?i:1/0,this.bids=this.schedule.getAllAds().slice(0,i).map(i=>{const{adPlayId:s}=this.getAdIds(i),o=r.getConfig(),{skipoffset:a}=this.config,l=null!=a&&a>=0,u=et(r,this.item),d={id:s,offset:e.offset,jwpseg:u,placement:K(o),tag:i._adQueue?i._adQueue[0]:i._currentTag,adClient:this.client};this.client===t&&(d.skipoffset=l?a:-1);const c=this.bidding.createNewBid(d,{getURLParts:Y});this.player.trigger("adBidRequest",xt(this,i,Object.assign({jwpseg:u},n))),c.init();const h=c.start().then(({result:e})=>{if(this.isDestroyed())return;let r=Promise.resolve();var s;e&&!e.error&&(i.jwpseg=u,e.adm?(i._adXML=e.adm,null!=i&&null!=(s=i._adQueue)&&s.length&&i._adQueue.unshift(e.adm)):e.tag&&(r=dt(e.tag,this.player,this.item,this.client,{},i).then(e=>{this.client===t?(i._adQueue=i._adQueue||[],i._adQueue.unshift(e)):i._adQueue=[e]})));return this.player.trigger("adBidResponse",xt(this,i,n)),r});return this.bidsPromises.push(h),c}),Promise.all(this.bidsPromises)}checkPreroll(t){if(this.bidTimeoutStarted||(this.bidTimeoutStarted=!0,this.bids.forEach(t=>t.timeout())),this.casting||this.preRollPlayed||this.adRules.shouldDeferAds())return;this.preRollPlayed=!0;const e=(null==t?void 0:t.startTime)||this.player.getPosition();this.lastTimeEvent=e||this.lastTimeEvent;const n=this.schedule.getPreRoll(e);if(!n&&!this.vmapPromise)return;(null!==this.vmapPromise||n&&"nonlinear"!==n._type)&&this.startBlocking(),this.bidsPromise.then(()=>{if(this.isDestroyed())return;const t=this.schedule.getPreRoll(e);t&&"nonlinear"!==t._type&&this.triggerAdBreakEvents(t,"pre")}),e?"none"===this.adRules.startOnSeek&&(this.prerollPromise=null):this.adRules.clearStartOnSeek();const r=null!=t&&t.playReason?t.playReason:s;this.playPreroll({adBlock:this.adBlockErrorDetected,startTime:e,reason:r})}checkMidrolls(t){if(this.casting||0===t.duration||this.adRules.shouldDeferAds())return;const e=this.schedule.getNextMidrollIndex(this.lastTimeEvent,t.position,t.duration);if(this.lastTimeEvent=t.position,null!==e){if(this.isAdLoading)return;const t=this.schedule.getMidRollAtIndex(e);"nonlinear"!==t._type&&(this.startBlocking(),this.triggerAdBreakEvents(t,"mid")),this.playMidrollAtIndex(e,{adBlock:this.adBlockErrorDetected})}else if(!this.preRollPlayed&&this.schedule.getClosestIndex(t.position,t.duration)<0)this.checkPreroll(t);else if(this.config.preloadAds){const e=t.position+5,n=this.schedule.peek(t.position,e,t.duration);if(null!==n&&n>=0)this.loadMidrollAtIndex(n,{adBlock:this.adBlockErrorDetected,preload:!0}).catch(t=>this.logger.debug(t));else if(-1===n){const e=F()+1e3*(t.duration-t.position);this.loadPostroll({adBlock:this.adBlockErrorDetected,preload:!0,startTime:e}).catch(t=>this.logger.debug(t))}else if(null===this.next&&null===this.nextPlaylistItemPromise&&e>t.duration){const t=this.player.getPlaylistIndex()+1,e=this.player.getPlaylistItem(t);if(this.nextPlaylistRelated=Boolean(this.relatedNextUp),e||this.relatedNextUp){const e=this.relatedNextUp?-1:t;this.nextPlaylistItemPromise=Promise.resolve(this.player.getPlaylistItemPromise(e)).then(()=>{this.isDestroyed()||(this.trigger("preloadNext",{item:this.player.getPlaylistItem(t)||this.relatedNextUp,index:e}),this.relatedNextUp=null,this.nextPlaylistItemPromise=null)}).catch(t=>this.logger.debug(t))}}}}checkPostrolls(t){if(this.casting||this.adRules.shouldDeferAds()||this.isDestroyed())return;const e=this.schedule.getPostRoll();e&&("nonlinear"!==e._type&&(this.startBlocking(),this.triggerAdBreakEvents(e,"post")),this.playPostroll(t))}getAdIds(t,{tagIndex:e,podIndex:n}={}){let r=t.adRequestIds&&void 0!==e?t.adRequestIds[e]:null;if(!r){const e=`p${n||t._adPodIndex||0}w${t._waterfallIndex||0}`;"p0w0"===e?r=t.adBreakId:(t.adPlayIds=t.adPlayIds||{},r=t.adPlayIds[e]=t.adPlayIds[e]||this.player.utils.genId(12))}return{adBreakId:t.adBreakId,adPlayId:r}}loadPreroll(t={}){return this.prerollPromise||(this.prerollPromise=this.bidsPromise.then(()=>{if(this.isDestroyed())return;const e=this.schedule.getPreRoll(t.startTime);return e?(e._position="pre",e._preload=!0,this.loadAd(e,t)):void 0})),this.prerollPromise}loadMidrollAtIndex(t,e){return this.midrollPromise[t]||(this.midrollPromise[t]=this.bidsPromise.then(()=>{if(this.isDestroyed())return;const n=this.schedule.getMidRollAtIndex(t);return n?(n._position="mid",n._preload=!0,this.loadAd(n,e)):void 0})),this.midrollPromise[t]}loadPostroll(t={}){return this.postrollPromise||(this.postrollPromise=this.bidsPromise.then(()=>{if(this.isDestroyed())return;const e=this.schedule.getPostRoll(t.startTime);return e?(e._position="post",e._preload=!0,this.loadAd(e,t)):void 0})),this.postrollPromise}playPreroll(t){this.prerollPromise?this.playPreloadedPromise(this.prerollPromise,t):this.bidsPromise.then(()=>{if(this.isDestroyed())return;const e=this.schedule.getPreRoll(t.startTime);e?(e._position="pre",this.startAdBreak(e,t)):this.stopBlocking()})}playMidrollAtIndex(t){this.midrollPromise[t]?this.playPreloadedPromise(this.midrollPromise[t]):this.bidsPromise.then(()=>{const e=this.schedule.getMidRollAtIndex(t);e&&(e._position="mid",this.startAdBreak(e))})}playPostroll(t){this.postrollPromise?this.playPreloadedPromise(this.postrollPromise):this.bidsPromise.then(()=>{const e=this.schedule.getPostRoll();e&&(e._position="post",this.startAdBreak(e,t))})}isDestroyed(){return null===this.player}destroy(){this.destroyBids(),this.player.off(null,null,this),this.player=null}destroyBids(){this.bids.forEach(t=>t.stop()),this.bidsPromises=[],this.bids=[]}enqueueAdEvent(t,e,n){this._events.push({type:t,event:e}),n.preload||this.dequeueAdEvents()}async waitForAdPlay(t){this.isAdLoading=!0;let e=!1;try{await t,e=!0}catch(t){var n;null==(n=this.logger)||n.debug(t)}return this.isAdLoading=!1,e}dequeueAdEvents(){}triggerAdBreakEvents(){}startBlocking(){this.player.trigger("adAttemptStart")}stopBlocking(){this.player.trigger("adAttemptEnd")}loadAd(){}playPreloadedPromise(){}startAdBreak(){}adBreakForecast(){}}const Xt=(t,e,...n)=>{if(null!=t&&t[e]&&"function"==typeof t[e])try{return t[e](...n)}catch(t){return null}return null},Gt=(t,n,r,i={})=>{n=n||null;const s={client:e};if(!t)return s;const{bidding:o,config:a,player:l}=t;Object.assign(s,{placement:K(l.getConfig()),viewable:l.getViewable()}),i.jwpseg&&(s.jwpseg=i.jwpseg),a.preloadAds&&(s.preloadAds=i.preload||(null==r?void 0:r._preload)||!1);const u=Xt(n,"getAdPodInfo");if(u){const t=Xt(u,"getTotalAds");if(t>1){const e=Xt(u,"getAdPosition");Object.assign(s,{sequence:e,podcount:t}),i.podIndex="number"==typeof e?e-1:0}if(void 0===s.adposition){const t=Xt(u,"getTimeOffset");s.adposition=0===t?"pre":-1===t?"post":"mid"}}if(r){const{adBreakId:e,adPlayId:n}=t.getAdIds(r,i);if(Object.assign(s,{tag:r._adQueue&&r._adQueue.length>0?r._adQueue[0]:r._adXML||r.adm,adBreakId:e,adPlayId:n,id:e,adposition:r._position}),r.jwpseg&&(s.jwpseg=r.jwpseg),o){const t=o.getBid(n);t&&Object.assign(s,t.getEventObject())}}const d=t.adsLoaderManager||i.loader;if(n){if(d){const t=s.mediationLayerAdServer;if("dfp"===t||"jwpdfp"===t){-1!==(Xt(n,"getWrapperAdSystem")||[]).concat(Xt(n,"getAdSystem")||[]).indexOf("SpotXJW")&&s.bidders.forEach(t=>{t.winner="SpotX"===t.name})}const e=d.userRequestContext;Object.assign(s,{tag:s.tag||d.getTag(n),ima:{ad:n,userRequestContext:e}})}Object.assign(s,{adtitle:n.getTitle(),adsystem:n.getAdSystem(),creativetype:n.getContentType(),duration:n.getDuration(),linear:n.isLinear()?"linear":"nonlinear",description:n.getDescription(),creativeAdId:n.getCreativeAdId(),adId:n.getAdId(),universalAdId:n.getUniversalAdIds().map(t=>({universalAdIdRegistry:t.g,universalAdIdValue:t.h})),advertiser:n.getAdvertiserName(),dealId:n.getDealId()});const t=n.getMediaUrl();t&&(s.mediaFile={file:t})}return void 0!==i.offset&&Object.assign(s,{adposition:s.adposition||i.offset,offset:i.offset}),s},Jt=(t,e,n,r,i)=>{const s=Gt(t,n,r,i),o=e.getVastErrorCode?e.getVastErrorCode():e.code;let a=e.getErrorCode?e.getErrorCode():e.adErrorCode;return a=a<1e4?a+2e4:a||60900,Object.assign(s,{message:`Ad Error: ${e.getMessage?e.getMessage():e.message}`,code:o>=100&&o<=1008?o:900,adErrorCode:a}),t&&(20402===a?s.timeout=t.options.loadVideoTimeout:21009===a?s.timeout=t.options.vastLoadTimeout:60004===a&&(s.timeout=t.options.requestTimeout)),void 0!==e.placement&&(s.placement=e.placement),void 0!==e.id&&(s.id=e.id),e.getInnerError&&(s.sourceError=e.getInnerError()),void 0!==e.tag&&(s.tag=e.tag),s},Kt=()=>null;class Yt{constructor(t,e){const{player:n,options:r,instreamProvider:i,view:s,adsLoaderManager:o,video:a,item:l,client:u}=t;if(n.utils.extend(this,n.Events),this.playlistItemManager=t,this.player=n,this.options=r,this.instreamProvider=i,this.view=s,this.adsLoaderManager=o,this.video=a,this.item=l,this.client=u,this.reason=e,this.env=n.getEnvironment(),this.utils=n.utils,this._qoe=new n.utils.Timer,this.logger=n.utils.logger.child("ads-googima/AdsPlayer"),r.customUi){const t=r.customUi;this.mainContainer=n.getContainer(),this.customUiDiv=document.getElementById(t.customUiDivId),this.adClickButton=document.getElementById(t.adClickButtonId),this.customCountDownDiv=document.getElementById(t.customCountDownId),this.customSkipButton=document.getElementById(t.customSkipButtonId),this.timeTillSkip=Number.POSITIVE_INFINITY}this.initAdsManagerPromise=null,this.blockingInstreamPlayer=null,this.currentAd=null,this.progressIntervalId=-1,this.viewablePlayedTime=0,this.lastPosition=null,this.adViewableImpressionHandler=Kt,this.paused=!1,this.playbackProxy={currentTime:this.player.getPosition(),duration:this.player.getDuration()},n.on("time",this.time,this)}time(t){this.playbackProxy.currentTime=t.position,t.duration>=t.position?this.playbackProxy.duration=t.duration:this.playbackProxy.duration=1/0}init(t,e,n){this.requestType=t,this.requestOptions=e,this.scheduledAd=n,this.offset=n._offset;const r=this.adsLoaderManager;return this.initAdsManagerPromise=this.initAdsManagerPromise||Ht(this.utils).then(()=>this.destroyed()?null:(this.logger.debug("Open adsLoaderManager"),r.open(t,e,this.video))).then(t=>{if(this.destroyed())return null;const n=r.getAdsManager(t,this.playbackProxy,this.options);if(this.instreamProvider.setProxy(n),r.bindEvents({AD_ERROR:this.adError.bind(this),LOADED:this.adLoaded.bind(this),CONTENT_PAUSE_REQUESTED:this.pauseRequested.bind(this),CONTENT_RESUME_REQUESTED:this.resumeRequested.bind(this),LOG:this.adLog.bind(this),STARTED:this.adStarted.bind(this),IMPRESSION:this.adImpression.bind(this),LINEAR_CHANGED:this.resize.bind(this),CLICK:this.adClick.bind(this),PAUSED:this.adPaused.bind(this),RESUMED:this.adResumed.bind(this),SKIPPED:this.adSkipped.bind(this),USER_CLOSE:this.adUserClose.bind(this),ALL_ADS_COMPLETED:this.allAdsCompleted.bind(this)},this),e.preloadAds)clearTimeout(this.timeoutAdStart);else{const{width:t,height:e}=this.player.getSafeRegion(!1),n=this.getViewMode();this.logger.debug("adsManager init with",t,e,n),r.init(t,e,n)}const i=n.getCuePoints();if(i.length){const t=i.filter(t=>t>0).map(t=>({begin:t,text:this.options.cuetext,cueType:"ads"}));this.player.addCues(t)}return n}).catch(t=>{if(clearTimeout(this.timeoutAdStart),this.asyncError&&!n._preload&&this.asyncError(t),null!=t&&t.getError){const e=t.getError();throw this.getAdErrorEventObject(e,t)}throw t}),this.initAdsManagerPromise}getViewMode(){const t=google.ima.ViewMode;return this.player.getFullscreen()?t.FULLSCREEN:t.NORMAL}beforeComplete(){const t=this.adsLoaderManager.adsManager;t&&t.getCuePoints().indexOf(-1)>-1&&this.playlistItemManager.startBlocking(),this.adsLoaderManager.unbindEvents(["CONTENT_RESUME_REQUESTED"]),this.logger.debug("Call contentComplete on IMA SDK"),this.adsLoaderManager.contentComplete()}requestAds(){var t,e;if(this.destroyed())return;this.logger.debug("Request ads to IMA SDK");let n=Promise.resolve();if(null!=this&&null!=(t=this.scheduledAd)&&null!=(e=t._adQueue)&&e.length){const t=this.scheduledAd._adQueue.map((t,e)=>dt(t,this.player,this.item,this.client,this.options,this.scheduledAd).then(t=>{t=it({player:this.player,item:this.item,tag:t,targetingConfig:this.options.config.targeting,enablePPS:this.options.config.enablePPS}),this.scheduledAd._adQueue[e]=t}));n=Promise.all(t)}return n.then(()=>{this.startRequestTimeout(),this.trigger("adRequest",Gt(this.playlistItemManager,null,this.scheduledAd)),this.adsLoaderManager.requestAds(this.requestType,this.requestOptions,this.options,this.scheduledAd)})}muteInstreamProvider(){const t=this.video.muted||this.player.getMute();this.logger.debug("Setting mute on instreamProvider",t),this.instreamProvider.mute(t)}pauseRequested(t){const e=this.playlistItemManager.schedule.isVMAP();e&&this.playlistItemManager.startBlocking();const n=null==t?void 0:t.getAd();if(e){const t=Xt(n,"getAdPodInfo"),e=Xt(t,"getTimeOffset");if(e){const t=-1===e?"post":"mid";this.scheduledAd._position=t,this.playlistItemManager.triggerAdBreakEvents(this.scheduledAd,t)}}const r=Gt(this.playlistItemManager,n,this.scheduledAd);this.trigger(p,r)}resumeRequested(){var t;this.logger.debug("ResumeRequest from IMA SDK"),null!=this&&null!=(t=this.currentAd)&&t.isLinear()&&this.finishAd(),this.blockingInstreamPlayer&&this.view.adTakeDown(),this.trigger("stopBlocking"),this.blockingInstreamPlayer=null}finishAd(){this.currentAd&&(this.hideCustomUi(),clearInterval(this.progressIntervalId),this.viewablePlayedTime=0,this.currentAd=null)}discardAdBreak(t){if(!t&&this.adsLoaderManager&&(t=this.adsLoaderManager.adsManager),this.destroyed()||!t)return;this.currentAd&&this.trigger(m,Gt(this.playlistItemManager,this.currentAd,this.scheduledAd));const e=t.getCuePoints();if(0!==e.length){if(!this.currentAd){const t=this.player.getPosition(),n=this.player.getCues(),r=e.find(e=>e>=t);this.player.setCues(n.filter(t=>(null==t?void 0:t.begin)!==r))}t.discardAdBreak(),t.stop()}else this.destroy()}asyncDiscardAdBreak(){this.initAdsManagerPromise&&this.initAdsManagerPromise.then(t=>this.discardAdBreak(t)).catch(t=>this.logger.debug(t))}pause({reason:t}){if(this.destroyed())return;const e=this.adsLoaderManager.adsManager;e&&(this.viewablePlayedTime=0,this.logger.debug("JW Player pause ad"),this.reason=t||s,e.pause())}resume({reason:t}){if(this.destroyed())return;const e=this.adsLoaderManager.adsManager;e&&(this.logger.debug("JW Player resume ad"),this.reason=t||s,e.resume())}startRequestTimeout(){clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout(()=>{this.logger.debug("Ad request timeout"),this.destroyed()||(this.asyncError=null,this.handleAdError({message:`Ad Request timeout after ${this.options.requestTimeout} milliseconds`,getErrorCode:()=>60004}),this.asyncDiscardAdBreak())},this.options.requestTimeout)}startAdsLoader(t){if(this.destroyed()||!this.initAdsManagerPromise)return Promise.reject();this.player.off("beforePlay",null,this),t&&(this.blockingInstreamPlayer=t,t.setText(this.options.loadingAd)),this.muteInstreamProvider(),this._qoe.tick("adBeforePlay"),this.startRequestTimeout(),this.initAdsManagerPromise.then(()=>{if(this.destroyed())return;const t=this.adsLoaderManager;if(!t.initialized){const{width:e,height:n}=this.player.getSafeRegion(!1),r=this.getViewMode();this.logger.debug("adsManager init with",e,n,r),t.init(e,n,r)}this.logger.debug("Start adsManager"),t.start()}).catch(t=>this.logger.debug(t))}resize(){const t=this.currentAd,e=this.adsLoaderManager.adsManager;if(!e)return;const n=t&&!t.isLinear(),r=this.player.getSafeRegion(n);if(n){let n=t.getHeight();n=this.player.getFullscreen()?r.height/2:Math.max(100,n+10),this.logger.debug("Resize adsManager",r.width,n,this.getViewMode()),e.resize(r.width,n,this.getViewMode()),this.view.resizeNonLinear(n)}else this.logger.debug("Resize adsManager",r.width,r.height,this.getViewMode()),e.resize(r.width,r.height,this.getViewMode()),this.view.resizeLinear()}setState(t,e,n){if(!t.isLinear())return;const i=Gt(this.playlistItemManager,t,this.scheduledAd);if(i.newstate=e,n&&(i.oldstate=n),null!==this.reason){i[e===r?"playReason":"pauseReason"]=this.reason,this.reason=null}this.instreamProvider.trigger("state",i)}customMainClickHandler(){this.adsLoaderManager.adsManager.resume()}customSkipHandler(t){if(t.stopPropagation(),this.timeTillSkip<=0){this.adsLoaderManager.adsManager.skip()}}customClickHandler(t){t.stopPropagation(),this.adsLoaderManager.adsManager.clicked()}addCustomEventHandlers(){this.mainClick=this.customMainClickHandler.bind(this),this.customSkip=this.customSkipHandler.bind(this),this.customClick=this.customClickHandler.bind(this),this.mainContainer.addEventListener("click",this.mainClick),this.adClickButton&&this.adClickButton.addEventListener("click",this.customClick),this.customSkipButton&&this.customSkipButton.addEventListener("click",this.customSkip)}removeCustomEventHandlers(){this.mainContainer.removeEventListener("click",this.mainClick),this.adClickButton&&this.adClickButton.removeEventListener("click",this.customClick),this.customSkipButton&&this.customSkipButton.removeEventListener("click",this.customSkip)}showCustomUi(){this.customUiDiv&&(this.customUiDiv.style.display="block",this.addCustomEventHandlers())}hideCustomUi(){this.customUiDiv&&(this.customUiDiv.style.display="none",this.removeCustomEventHandlers())}adLoaded(t){clearTimeout(this.timeoutAdStart);const e=t.getAd();if(this.playlistItemManager.schedule.isVMAP()){const t=Xt(e,"getAdPodInfo"),n=Xt(t,"getTimeOffset");n&&(this.scheduledAd._position=-1===n?"post":"mid")}const n=Gt(this.playlistItemManager,e,this.scheduledAd);this.trigger("adLoaded",n)}adStarted(t){this.player.getPip()&&this.player.requestPip(this.view.getAdDiv().querySelector("video"));const e=t.getAd();this.currentAd=e,this.paused=!1,e.isUiDisabled()&&this.showCustomUi();const n=Gt(this.playlistItemManager,e,this.scheduledAd);this.trigger(g,n)}adImpression(t){this.view.adSetup();const e=t.getAd(),n=e.isLinear(),i=n&&(e.getContentType().indexOf("image")>=0||-1===e.getDuration()),s=this.isVpaidAd(e),o=n&&s&&this.options.vpaidcontrols;this.currentAd=e,this.blockingInstreamPlayer&&this.blockingInstreamPlayer.setSkipOffset(e.getSkipTimeOffset()),this.adsLoaderManager.bindEvents({COMPLETE:this.adComplete.bind(this)}),s&&this.env.OS.mobile&&this.options.autoplayadsmuted&&this.adsLoaderManager.bindEvents({VOLUME_CHANGED:()=>{this.adsLoaderManager.unbindEvents(["VOLUME_CHANGED"]),this.player.setMute(0===this.adsLoaderManager.adsManager.getVolume())}}),n||this.trigger("stopBlocking",{isNonlinear:!0}),this.utils.toggleClass(this.player.getContainer(),y,n&&(i||s)),this.utils.toggleClass(this.player.getContainer(),v,o),this.resize(),this.muteInstreamProvider(),clearTimeout(this.timeoutAdStart);const a=this.adsLoaderManager.adsManager;this.progressInterval(e,a);const l=Gt(this.playlistItemManager,e,this.scheduledAd),u=void 0===l.podcount||1===l.sequence;"pre"===l.adposition&&u&&(this._qoe.tick("adImpression"),l.timeLoading=this._qoe.between("adBeforePlay","adImpression")),n&&!u&&this.trigger(p,l),this.trigger("adImpression",l,e),this.setupViewableListener(),this.setState(e,r,"buffering")}progressInterval(t,e){if(clearInterval(this.progressIntervalId),!e)return;const n=t.getAdId(),r=t.isSkippable()&&this.customSkipButton;let i=-1;const s=this.options.admessage||"",o=this.options.podmessage||"",l=this.options.skipmessage||"",u=this.options.skiptext||"",d=new RegExp("__AD_POD_CURRENT__","g"),c=new RegExp("__AD_POD_LENGTH__","g");this.progressIntervalId=setInterval(()=>{if(!this.currentAd||this.currentAd.getAdId()!==n)return void clearInterval(this.progressIntervalId);const h=e.getRemainingTime();if(isNaN(h)||h<=0)return;if(i===h)return;i=h;const f=this.currentAd.getDuration(),p=f-h,g=Math.round(f-p);if(r){const e=this.timeTillSkip=Math.ceil(t.getSkipTimeOffset()-p);e>0?(this.customSkipButton.innerText=l.replace(/(\b)xx(s?\b)/g,`$1${e}$2`),this.customSkipButton.style.cursor="default"):(this.customSkipButton.innerText=u,this.customSkipButton.style.cursor="pointer")}if(this.blockingInstreamPlayer){let t=s.replace(/(\b)xx(s?\b)/g,`$1${g}$2`);const e=Xt(this.currentAd,"getAdPodInfo");if(e){const n=Xt(e,"getTotalAds");if(n>1){const r=Xt(e,"getAdPosition");t=`${o.replace(d,r).replace(c,n)}  ${t}`}}this.blockingInstreamPlayer.setText(t),this.customCountDownDiv&&(this.customCountDownDiv.innerText=t),this.instreamProvider.trigger(a,{duration:f,position:p})}if(f>0){const e=Gt(this.playlistItemManager,t,this.scheduledAd);e.position=p,e.duration=f,this.adViewableImpressionHandler(e),this.trigger("adTime",e)}},250)}setupViewableListener(){this.player.off(i,this.viewableHandler,this),this.player.on(i,this.viewableHandler,this),this.viewableHandler({viewable:this.player.getViewable()})}adViewableHandler(t){const{position:e}=t;null===this.lastPosition&&(this.lastPosition=e);let n=e-this.lastPosition;if(this.lastPosition=e,n=Math.min(Math.max(0,n),4),this.viewablePlayedTime+=n,this.viewablePlayedTime>=2){this.player.off(i,this.viewableHandler,this),this.adViewableImpressionHandler=Kt;const t=Gt(this.playlistItemManager,this.currentAd,this.scheduledAd);this.trigger("adViewableImpression",t)}}viewableHandler(t){t.viewable?(this.viewablePlayedTime=0,this.lastPosition=null,this.adViewableImpressionHandler=this.adViewableHandler):this.adViewableImpressionHandler=Kt}adComplete(t){const e=t.getAd();this.finishAd();const n=Gt(this.playlistItemManager,e,this.scheduledAd);this.trigger("adComplete",n),this.adsLoaderManager.unbindEvents(["VOLUME_CHANGED"])}adClick(t){const e=this.adsLoaderManager.adsManager,n=t.getAd();this.reason="clickthrough",this.isVpaidAd(n)||(this.logger.debug("Ad paused due to ad click"),e.pause());const r=Gt(this.playlistItemManager,n,this.scheduledAd);this.trigger("adClick",r)}adPaused(t){if(!this.paused){this.paused=!0;const e=t.getAd();null===this.reason&&this.isVpaidAd(e)&&(this.reason=o),this.setState(e,"paused")}}adResumed(t){if(this.paused){this.paused=!1;const e=t.getAd();null===this.reason&&this.isVpaidAd(e)&&(this.reason=o),this.setState(e,r)}}adSkipped(t){const e=t.getAd();this.logger.debug("AdSkipped"),this.adsLoaderManager.unbindEvents(["COMPLETE","VOLUME_CHANGED"]),this.finishAd();const n=Gt(this.playlistItemManager,e,this.scheduledAd);this.trigger(m,n)}adUserClose(t){var e;this.logger.debug("AdUserClose"),null!=this&&null!=(e=this.currentAd)&&e.isLinear()&&-1===this.currentAd.getDuration()?this.adSkipped(t):(this.adsLoaderManager.unbindEvents(["COMPLETE","VOLUME_CHANGED"]),this.finishAd())}allAdsCompleted(){this.stopAdsManager(),this.trigger("allAdsComplete",{})}stopAdsManager(){this.initAdsManagerPromise.then(t=>{this.destroyed()||(this.logger.debug("Stop IMA SDK adsManager"),t.stop(),t.destroy(),this.initAdsManagerPromise=null)}).catch(t=>this.logger.debug(t))}adLog(t){this.logger.debug(t.type,t);const e=Xt(t,"getAdData"),n=null==e?void 0:e.adError;if(n&&402===n.getVastErrorCode())this.handleAdError(n,t);else if(n){const e=Xt(t,"getAd");this.trigger(f,Jt(this.playlistItemManager,n,e,this.scheduledAd,{jwpseg:this.adsLoaderManager.getJwpSeg(e)}))}}adError(t){const e=t.getError();this.handleAdError(e,t)}asyncError(t){var e;if(!this.destroyed())if(clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout(()=>this.destroy(),0),null!=t&&t.getError){const e=t.getError();this.handleAdError(e,t,!0)}else null!=t&&null!=(e=t.target)&&e.src?this.logger.error(`Failed to load ${t.target.src}`):this.logger.error(t)}getAdErrorEventObject(t,e){const n=Xt(e,"getUserRequestContext"),r=n?n.offset:void 0;return Jt(this.playlistItemManager,t,null,this.scheduledAd,{offset:r})}handleAdError(t,e,n){this.options.debug&&this.logger.error(t);const r=this.getAdErrorEventObject(t,e);this.player&&0===this.player.getPosition()&&(this._qoe.tick("adError"),r.timeLoading=this._qoe.between("adBeforePlay","adError")),this.trigger(f,r),this.destroyed()||(900===t.getErrorCode()||n?(clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout(()=>this.destroy(),0)):this.destroy())}isVpaidAd(t){const e=t.getContentType();return"application/javascript"===e||"application/x-shockwave-flash"===e}destroy(){this.logger.debug("JW Player destroy AdsPlayer"),this.trigger("stopBlocking",{isDestroyed:!0}),this.off(),this.destroyed()||(this.player.off(null,null,this),clearTimeout(this.timeoutAdStart),clearInterval(this.progressIntervalId),this.currentAd=null,this.options=null,this.adsLoaderManager.reset(null,!0),this.view.adTakeDown(),this.video=null,this.initAdsManagerPromise=null,this.instreamProvider.off(),this.instreamProvider.setProxy(null),this.instreamProvider=null,this.view=null,this.player=null)}destroyed(){return!this.player}}let Zt=null;class te extends Qt{constructor(t,n,r,i,s,o,a,l,u,d){super(t,n,r,i,d),t.utils.extend(this,t.Events),this.client=e,this.config=i,this.options=s,this.player=t,this.utils=t.utils,this.adsLoaderManager=l,this.view=a,this.qoe=new t.utils.Timer,this.instreamProvider=o,this.vmapPromise=Promise.resolve(),this.fullscreenIcon=t.getContainer().querySelector(".jw-icon-fullscreen"),this.video=u,this.hasPreroll=!0,this.reason=null}checkPreroll(t){this.adsLoaderManager.initializeDisplay({restrict:!0}),this.reason=null!=t&&t.playReason?t.playReason:s,super.checkPreroll(t)}checkPostrolls(t){this.schedule.isVMAP()&&this.adsPlayer?this.adsPlayer.beforeComplete():super.checkPostrolls(t)}createAdsPlayer(t){this.adsPlayer&&!this.adsPlayer.destroyed()||(this.adsPlayer=new Yt(this,this.reason),this.adsPlayer.on("all",(e,n)=>"allAdsComplete"===e?(this.adsPlayer.destroy(),void(this.adsPlayer=null)):"stopBlocking"===e?(this.stopBlocking(null==n?void 0:n.isNonlinear),void(!t&&n&&n.isDestroyed&&(this.adsPlayer=null))):void("adError"!==e?(this.dequeueAdEvents(),this.trigger(e,n)):this.enqueueAdEvent(e,n,{preload:t}))))}initAdsPlayer(t,e,n){return t===A&&(this.reason=s),this.createAdsPlayer(n._preload),this.player.on("resize",()=>this.adsPlayer.resize(),this.adsPlayer).on("fullscreen",()=>this.adsPlayer.resize(),this.adsPlayer),this.adsPlayer.init(t,e,n).then(t=>{this.trigger("adsManager",{adsManager:t,videoElement:this.video})})}adLoadRequest(t,e){const n=this.utils.extend({},this.config);n.ad=t,this.offset=t.offset||this.offset,n.adPosition=st(this.player);const r=new qt(n,this.player.getConfig(),this.utils),i=e?b:A,s=this.initAdsPlayer(i,r,t);return Ht(this.utils).then(()=>(this.adsPlayer.requestAds(),s))}pause(t){this.adsPlayer&&this.adsPlayer.pause(t||{})}resume(t){this.adsPlayer&&this.adsPlayer.resume(t||{})}skipAd(){this.adsLoaderManager&&this.adsLoaderManager.skipAd()}skipAdBreak(){this.adsPlayer&&this.adsPlayer.asyncDiscardAdBreak()}dequeueAdEvents(){this._events.forEach(({type:t,event:e})=>{this.trigger(t,e)}),this._events.splice(0)}triggerAdBreakEvents(t,e){var n;t._position=t._position||e,this.blockingInstreamPlayer.once("destroyed",()=>{this.dequeueAdEvents(),this.trigger("adBreakEnd",Gt(this,null,t))});const r=Gt(this,null,t);this.trigger("adBreakStart",r),this.dequeueAdEvents(),null!=this&&null!=(n=this.adsPlayer)&&n.destroyed()&&this.stopBlocking()}async startBlocking(){if(!this.blockingInstreamPlayer&&!this.destroyed()){if(super.startBlocking(),this.blockingInstreamPlayer=this.player.createInstream().init(),this.blockingInstreamPlayer.applyProviderListeners(this.instreamProvider),this.qoe.tick("adLoading"),this.blockingInstreamPlayer.adPlayPromise){if(!await this.waitForAdPlay(this.blockingInstreamPlayer.adPlayPromise))return}!function(t){if(Zt=t.getEnvironment(),!Zt||Zt.Features||Zt.Features.headless||!Zt.OS.iOS||Zt.Browser.version.major<10)return;const e=t.getContainer();e.requestFullscreen||e.webkitRequestFullscreen||t.getFullscreen()&&t.setFullscreen(!1)}(this.player),this.utils.addClass(this.player.getContainer(),P),this.adsPlayer&&!this.adsPlayer.destroyed()&&(this.adsPlayer.blockingInstreamPlayer=this.blockingInstreamPlayer),this.view.adSetup()}}stopBlocking(t){if(!this.destroyed()){var e;if(super.stopBlocking(),this.player.off("viewable",null,this),this.utils.removeClass(this.player.getContainer(),[y,v,P]),this.blockingInstreamPlayer)this.instreamProvider.off(),this.blockingInstreamPlayer.destroy(),this.blockingInstreamPlayer=null,null==(e=this.player)||e.trigger("adRequestedContentResume");t||this.view.adTakeDown()}}loadAd(t,e){if(t)return this.adsPlayer&&this.adsPlayer.scheduledAd!==t&&this.adsPlayer.destroy(),t._preload=!0,this.adLoadRequest(t,e)}playPreloadedPromise(t){t.then(()=>this.adsPlayer.startAdsLoader(this.blockingInstreamPlayer)).catch(()=>{this.stopBlocking()})}startAdBreak(t,e){t&&(((t,e)=>{var n;let r;if(null!=t&&null!=(n=t._adQueue)&&n[0]){try{r=new URL(t._adQueue[0],window.location).protocol}catch(t){e.utils.logger.debug(t)}"https:"!==r&&"https:"===window.location.protocol&&e.trigger(f,{message:"VPAID insecure request was blocked.",code:901,adErrorCode:50005})}})(t,this.player),this.adsPlayer&&this.adsPlayer.scheduledAd!==t&&this.adsPlayer.destroy(),this.startBlocking(),this.dequeueAdEvents(),this.adLoadRequest(t,e).then(()=>{this.adsPlayer.startAdsLoader(this.blockingInstreamPlayer)}).catch(()=>{this.stopBlocking()}))}destroy(){this.stopBlocking();const t=this.adsLoaderManager;t&&(t.reset(),this.adsLoaderManager=null),this.adsPlayer&&this.adsPlayer.destroy(),this.adsPlayer=null,super.destroy()}destroyed(){return null===this.adsLoaderManager}}var ee=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)};class ne{constructor(t,e){this.adsLoader=null,this.adDisplayContainer=null,this.displayInitialized=!1,this.initialized=!1,this.started=!1,this.adsRequest=null,this.userRequestContext=null,this.adsManager=null,this.adsLoaderEvents={},this.adsManagerEvents={},this.container=e,this.schedule=null,this.breakMap={},this.player=t,this.environment=t.getEnvironment(),this.logger=t.utils.logger.child("ads-googima/ima/AdsLoader")}getVpaidMode(t){const e=google.ima.ImaSdkSettings.VpaidMode;return"disabled"===t||"none"===t?e.DISABLED:"enabled"===t?e.ENABLED:e.INSECURE}initializeDisplay(t){this.adDisplayContainer&&!this.displayInitialized&&(this.adDisplayContainer.initialize(),null!=t&&t.restrict&&(this.displayInitialized=!0))}contentComplete(){this.adsLoader&&this.adsLoader.contentComplete()}reset(t,e){if(e){this.adsRequest=null,this.userRequestContext=null;const t=this.adsManager;t&&(t.destroy(),this.adsManager=null),this.adsManagerEvents={},Object.keys(this.adsLoaderEvents).forEach(t=>{this.adsLoader.removeEventListener(t,this.adsLoaderEvents[t])}),this.adsLoaderEvents={}}else this.contentComplete();t&&(this.schedule=null,this.breakMap={}),this.initialized=this.started=!1}prepare(t,e){const n=google.ima.settings;n.setDisableCustomPlaybackForIOS10Plus(!0);const r=e.locale||this.player.getConfig().language;n.setLocale(r);const i=e.ppid;return i&&n.setPpid(i),"enabled"===e.omidSupport&&n.setFeatureFlags({enableOmidBeta:!0}),e.maxRedirects>=0&&n.setNumRedirects(e.maxRedirects),null===this.adsLoader&&(this.adDisplayContainer=new google.ima.AdDisplayContainer(this.container,t),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer)),this.adsLoader}open(t,e,n){const r=this.prepare(n,e);return new Promise((t,e)=>{r.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e,!1),r.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,t,!1),this.adsLoaderEvents[google.ima.AdErrorEvent.Type.AD_ERROR]=e,this.adsLoaderEvents[google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED]=t})}requestAds(t,e,n,r){var i,s,o;if(null!==this.adsRequest)return;if(!r)return;const a=this.player,l=this.adsRequest=new google.ima.AdsRequest,u=this.userRequestContext={requestType:t,vpaidMode:e.vpaidmode,playerVersion:a.version.split("+")[0],adPosition:e.adPosition};l.setAdWillAutoPlay(!1!==a.getConfig().autostart),l.setAdWillPlayMuted(a.getMute());const d=a.getSafeRegion(!1);l.linearAdSlotWidth=d.width,l.linearAdSlotHeight=d.height;const c=ee((null==(i=google)?void 0:i.ima)||{},"VideoOrientation")&&ee(l,"preferredLinearOrientation")&&["UNSET","LANDSCAPE","PORTRAIT","SQUARE"].every(t=>ee(google.ima.VideoOrientation,t)),h="true"===(f=(f="string"!=typeof(f=null==(s=a.getConfig())||null==(o=s.advertising)?void 0:o.adOrientation)?String(f):f).trim().toLowerCase())?"SET_AUTOMATICALLY":"0"===f||"unset"===f?"UNSET":"1"===f||"landscape"===f?"LANDSCAPE":"2"===f||"portrait"===f?"PORTRAIT":"3"===f||"square"===f?"SQUARE":"DO_NOT_SET";var f;if(c&&"DO_NOT_SET"!==h){const t=Number(d.width)||0,e=Number(d.height)||0;let n="UNSET";"SET_AUTOMATICALLY"!==h?n=h:t>e?n="LANDSCAPE":t<e?n="PORTRAIT":0!==t&&0!==e&&t===e&&(n="SQUARE"),l.preferredLinearOrientation=google.ima.VideoOrientation[n]}const p=a.getSafeRegion(!0);l.nonLinearAdSlotWidth=p.width,l.nonLinearAdSlotHeight=p.height,l.forceNonLinearFullSlot=n.forceNonLinearFullSlot,l.vastLoadTimeout=n.vastLoadTimeout,"enabled"===e.omidSupport&&(l.omidAccessModeRules=e.omidAccessModeRules);const g=this.adsLoader.getSettings(),m=this.getVpaidMode(u.vpaidMode);if(g.setPlayerType("jwplayer"),g.setPlayerVersion(u.playerVersion),g.setVpaidMode(m),r._pod)l.adsResponse=u.adsResponse=((t,e)=>{const n=document.implementation.createDocument("http://www.iab.net/videosuite/vmap","vmap:VMAP",null),r=n.documentElement;return r.setAttribute("version","1.0"),t.forEach(t=>{const i=n.createElement("vmap:AdTagURI");i.appendChild(n.createCDATASection(t));const s=r.appendChild(n.createElement("vmap:AdBreak")),o=`${e}`.replace("pre","start").replace("post","end");s.setAttribute("timeOffset",o);const a=s.appendChild(n.createElement("vmap:AdSource"));a.setAttribute("allowMultipleAds","true"),a.setAttribute("followRedirects","true"),a.appendChild(i)}),r.outerHTML||(new XMLSerializer).serializeToString(r)})(r._pod,r._offSet);else if(r.adm||r._adXML)l.adsResponse=u.adsResponse=r.adm||r._adXML;else if(r.tag||r._adQueue&&1===r._adQueue.length){const t=r.tag||r._adQueue[0];l.adTagUrl=u.adTagUrl=t.trim()}else{var y;const t=null!=r&&null!=(y=r._adQueue)&&y.length?(t=>{const e=document.implementation.createDocument("http://www.w3.org/2001/XMLSchema-instance","VAST",null),n=e.documentElement;return n.setAttribute("version","2.0"),t.forEach((t,r)=>{const i=e.createElement("Ad");i.setAttribute("id",r);const s=e.createElement("Wrapper"),o=e.createElement("Extensions"),a=e.createElement("Extension");a.setAttribute("type","waterfall"),a.setAttribute("fallback_index",r);const l=e.createElement("VASTAdTagURI");l.appendChild(e.createCDATASection(t)),i.appendChild(s),s.appendChild(l),s.appendChild(o),o.appendChild(a),n.appendChild(i)}),n.outerHTML||(new XMLSerializer).serializeToString(n)})(r._adQueue):r.xml;l.adsResponse=u.adsResponse=t}this.adsLoader.requestAds(l,u)}getAdsManager(t,e,n){const r=new google.ima.AdsRenderingSettings;r.enablePreloading=n.enablePreloading||n.preloadAds,r.loadVideoTimeout=n.loadVideoTimeout,r.uiElements=null,r.useStyledNonLinearAds=!0,this.environment.OS.android&&this.environment.Browser.chrome&&this.environment.Browser.version.major>=84&&(r.mimeTypes=["video/mp4","video/webm","audio/mp4","audio/webm"]);const i=this.player.getConfig().bandwidthEstimate;if(r.bitrate=i?i/1e3:-1,n.customUi){n.customUi.disableUi&&(r.disableUi=!0)}return this.adsManager=t.getAdsManager(e,r),this.userRequestContext=t.getUserRequestContext(),this.adsManager}init(t,e,n){null!==this.adsManager&&!1===this.initialized&&(this.adsManager.init(t,e,n),this.initialized=!0)}start(){null!==this.adsManager&&!1===this.started&&(this.initializeDisplay({restrict:!0}),this.adsManager.start(),this.started=!0)}bindEvents(t){const e=google.ima.AdEvent.Type,n=google.ima.AdErrorEvent.Type;Object.keys(t).forEach(r=>{const i=e[r]||n[r],s=this.adsManagerEvents[i];s&&this.adsManager.removeEventListener(i,s),this.adsManager.addEventListener(i,t[r],!1),this.adsManagerEvents[i]=t[r]})}unbindEvents(t){const e=google.ima.AdEvent.Type,n=google.ima.AdErrorEvent.Type;t.forEach(t=>{const r=e[t]||n[t],i=this.adsManagerEvents[r];i&&(this.adsManager.removeEventListener(r,i),delete this.adsManagerEvents[r])})}getTag(t){if("string"==typeof this.schedule)return this.schedule;const e=Xt(t,"getAdPodInfo");if(e){const t=this.breakMap[Xt(e,"getTimeOffset")]||{};if(t.tag)return t.tag}return this.userRequestContext?this.userRequestContext.adTagUrl||this.userRequestContext.adsResponse||"":(this.logger.error("invalid request context",this.userRequestContext),"")}getJwpSeg(t){const e=Xt(t,"getAdPodInfo");if(e){var n,r;const t=Xt(e,"getTimeOffset");return null==this||null==(n=this.breakMap)||null==(r=n[t])?void 0:r.jwpseg}return null}_getTimeoffsetFromPosition(){const t=this.player.getPosition();let e,n=1/0;return Object.keys(this.breakMap).forEach(r=>{const i=t-r;i>=0&&i<n&&(e=r,n=i)}),n===1/0?-1:e}skipAd(){this.adsManager&&this.adsManager.skip()}getBid(t){const e=tt(t,this.player.utils);return this.breakMap[e]?this.breakMap[e].bid:null}setBid(t,e){const n=tt(t,this.player.utils);this.breakMap[n]=this.breakMap[n]||{},this.breakMap[n].bid=e}destroy(){var t,e;null==(t=this.adDisplayContainer)||t.destroy(),this.adDisplayContainer=null,null==(e=this.adsLoader)||e.destroy(),this.adsLoader=null,this.reset(!0,!0)}}const re="__JWP____ePBPK____";let ie={};window[re]?ie=window[re]:window[re]=ie;const se={},oe={},ae=(t,e)=>{const n=ie[e];return n||(ie[e]=new Promise((n,r)=>{const i=new t.key(e);if("unlimited"===i.edition())return r();const s=["//","entitlements.jwplayer.com","/",i.token(),".json"];"file:"===window.location.protocol&&s.unshift("https:"),t.ajax(s.join(""),function(t){const e=null==t?void 0:t.response;e?n(e):r()},function(){r()},{timeout:1e4,responseType:"json"})}))},le=(t,e)=>{const n=se[e];return n||(se[e]=ae(t,e).catch(()=>({})).then(t=>{if(!1===t.canUseVPB)throw new Error("Not entitled for Player Bidding")}))},ue=(t,e,n)=>{const r=oe[e];return r||(oe[e]=ae(t,e).catch(()=>({})).then(t=>{let e,r;if(!0===n.outstream?(e=!1!==t.canPlayOutstreamAds,r="Outstream Ad Limit Reached"):(e=!1!==t.canPlayAds,r="Ad Limit Reached"),!1===e)throw new Error(r);return{message:"Can Play Ads"}}))};var de="8.10.0";!function(t){if(t&&"undefined"!=typeof window){var e=document.createElement("style");e.setAttribute("media","screen"),e.innerHTML=t,document.head.appendChild(e)}}(".jw-plugin-googima{overflow:hidden;width:100%;height:100%;display:block;visibility:hidden;pointer-events:none;opacity:0}.jw-plugin-googima.jw-ad-instream{visibility:visible;display:block;pointer-events:all;opacity:1}.jw-plugin-googima.jw-ad-instream .jw-ads-view>:not(div),.jw-plugin-googima.jw-ad-instream .jw-ads-view>div:not(:empty){width:100%;height:100%}.jw-plugin-googima.jw-ad-linear{top:0;left:0;bottom:0}.jw-plugin-googima.jw-ad-non-linear{top:auto}.jw-plugin-googima .jw-ads-view{position:absolute;width:100%;height:100%}.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-controlbar{font-size:1em}.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-display-icon-display,.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-display-icon-display .jw-icon-display{pointer-events:none}.jwplayer.jw-flag-ads-googleima .jw-controlbar{background:0 0!important;pointer-events:none}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-horizontal-volume-container{pointer-events:auto}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-icon{pointer-events:all}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-icon-fullscreen:not(.jw-fullscreen-ima){display:none}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-fullscreen-ima{display:flex}.jwplayer.jw-flag-ads-googleima .jw-controls-backdrop{display:none}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume,.jwplayer.jw-flag-ads-googleima.jw-ie .jw-svg-icon{background:rgba(0,0,0,.25);border-radius:3px}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume{margin:0 10px}@supports (filter:drop-shadow(0 0 3px #000)){.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume,.jwplayer.jw-flag-ads-googleima.jw-ie .jw-svg-icon{background:0 0;border-radius:0}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume{margin:0}}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-svg-icon{fill:#fff;filter:drop-shadow(0 0 3px #000)}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-text{text-shadow:0 0 3px #000!important}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player.jw-flag-ads.jw-state-playing.jw-flag-touch:not(.jw-flag-ads-vpaid) .jw-controls .jw-controlbar{pointer-events:none}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-controlbar{flex-flow:column-reverse nowrap;height:100%;max-height:none}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-button-container{align-items:flex-end;flex-wrap:wrap;margin-bottom:7px}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-controlbar .jw-icon{height:30px}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-text{align-self:flex-start;margin:16px 0 0 16px;order:-1;width:100%}"),function(t,e,n){try{(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)(t,e,n)}catch(t){}}(e,"8.1",class extends E{constructor(t,n,r,i){super(t,n,r,e),this.player.utils.extend(this,this.player.Events),this.configScheduleParser=new Tt(this.player,this.pluginConfig,e),this.options=new qt(this.pluginConfig||{},this.player.getConfig(),this.player.utils),this.adRules=this.configScheduleParser.getAdRules(),this.videoElement=null,this.playlistItemEventCount=0,this.nextPlaylistItemManager=null,this.nextPlaylistRelated=!1,this.bidsBlock=this.pluginConfig.bids,this.logger=t.utils.logger.child("ads-googima/googimaPlugin"),i&&i.sdkPromise&&i.checkEntitlements?(i.checkEntitlements(),i.sdkPromise()):(!function(t,e,n,r){const i=e.key,s=t.utils,o=ue(s,i,n),a=s.logger.child("ads-shared/checkEntitlements");let l;o.catch(t=>a.debug(t)),n.bids&&(l=le(s,i),l.catch(t=>a.debug(t))),t.on("ready",()=>{l&&l.catch(n=>{t.trigger("destroyBidding"),t.trigger(f,Rt(n.message,60009,e,r))}),o.catch(n=>{t.trigger("destroyPlugin",n),t.trigger(f,Rt(n.message,60002,e,r))})})}(this.player,this.playerConfig,this.pluginConfig,e),Ht(this.player.utils).catch(t=>this.logger.debug(t))),this.view=new zt(this.div,this.player.id,this.player.utils),this.instreamProvider=new Ft(this.player.utils,this.player.Events,this.view),this.adsLoader=new ne(this.player,this.view.getAdDiv()),this.version=de;const s=this.player.getConfig().advertising;if(null!=s&&s.overrideAdConfigActive){const t=()=>{this.logger.debug("api disabled by overrideAdConfig entitlement")};this.player.loadAdTag=t,this.player.loadAdXml=t,this.player.loadAdBreak=t,this.player.playAd=t}else this.player.loadAdTag=this.loadAdTag.bind(this),this.player.loadAdXml=this.loadAdXml.bind(this),this.player.loadAdBreak=this.loadAdBreak.bind(this),this.player.playAd=this.loadAdTag.bind(this);this.player.on("ready",this.onReady,this),this.player.on("playlistItem",this.onPlaylistItemCallback,this),this.player.on("playlistComplete",this.onPlaylistCompleteCallback,this),this.player.on("cast",this.onCastCallback,this),this.player.on("mute",this.onMuteCallback,this),this.player.on("destroyPlugin",this.onDestroyPlugin,this),this.player.on("destroyBidding",this.onDestroyBidding,this),this.player.isReady()&&this.lateInitAfterReady()}getCompanions(t,e,n,r){try{return t.getCompanionAds(e,n,r)}catch(t){return[]}}addCompanionsToDOM(t){if(!t||!t.length)return;const e=document.getElementById(this.options.companiondiv.id);if(!e)return;const n=t[0];n&&("function"==typeof n.getContent?e.innerHTML=n.getContent():e.innerHTML=n.resource||n.content)}convertCompanions(t){const e=[];for(let n=0;n<t.length;n++){const r=t[n];e.push({width:r.getWidth(),height:r.getHeight(),type:"html",resource:r.getContent()})}return e}manageCompanionAd(t){const e=t.currentAd;let n=new google.ima.CompanionAdSelectionSettings;n.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE;const r=this.options.companiondiv||{width:300,height:250},i=this.convertCompanions(this.getCompanions(e,r.width,r.height,n));let s=i.length;if(s){const n=Gt(this.playlistItemManager,e,t.scheduledAd);n.companions=i,this.player.trigger("adCompanions",n)}if(this.options.companiondiv){n=new google.ima.CompanionAdSelectionSettings,this.options.companionResourceType&&(n.resourceType=google.ima.CompanionAdSelectionSettings.ResourceType[this.options.companionResourceType]);const t=this.getCompanions(e,this.options.companiondiv.width,this.options.companiondiv.height,n);s=Math.max(s,t.length),this.addCompanionsToDOM(t)}return s>0}resetSchedule(t){var e;null!=this&&null!=(e=this.playlistItemManager)&&e.adsPlayer&&this.playlistItemManager.adsPlayer.destroy(),this.reset(t),this.adsLoader.contentComplete(),function(t){const e=t.getCues();if(Array.isArray(e)&&e.length){const n=e.filter(t=>"ads"!==t.cueType);t.setCues(n)}}(this.player)}createPlaylistItemManager(t,e,n,r){const i=t.item||{},s=this.configScheduleParser.getSchedule(i,n.playlistItemEventCount),o=new(null!=r&&r.PlaylistItemManager?r.PlaylistItemManager:te)(this.player,s,i,this.pluginConfig,this.options,this.instreamProvider,this.view,this.adsLoader,this.videoElement,this.casting);return o.on("all",(t,e)=>{if("preloadNext"===t){const t=Object.assign({},n,{preloadPreroll:!0,playlistItemEventCount:this.playlistItemEventCount+1});return void(o.next=this.createPlaylistItemManager(e,b,t))}this.player.trigger(t,e)}),o.init(this.bidsBlock,n),o.on(g,()=>this.manageCompanionAd(o.adsPlayer)),o}handlePlaylistItem(t,e,n,r){null!=r&&r.sdkPromise?r.sdkPromise():Ht(this.player.utils).then(()=>{this.adsLoader.prepare(this.videoElement,n)});const i=t.item||this.player.getPlaylistItem(t.index);this.resetSchedule(!0);const s=this.configScheduleParser.getSchedule(i,this.playlistItemEventCount);!(e===b&&!this.adRules.rulesAllowAdPlayback(this.playlistItemEventCount))&&s&&(s.getAllAds().length||s.isVMAP())&&(this.nextPlaylistItemManager&&i!==this.nextPlaylistItemManager.item&&!1===this.nextPlaylistRelated&&(this.nextPlaylistItemManager.off(null,null,this),this.nextPlaylistItemManager.destroy(),this.nextPlaylistItemManager=null),this.adsLoader.reset(!0),this.playlistItemManager=this.nextPlaylistItemManager||this.createPlaylistItemManager(t,e,n),this.playlistItemManager.attachListeners(),this.nextPlaylistItemManager=null,this.nextPlaylistRelated=!1)}loadAdTag(t,e){let n;n=this.player._.isArray(t)?t.slice(0):[t],this.buildAndLoadAdObj({_adQueue:n},e)}loadAdXml(t,e){this.buildAndLoadAdObj({_adXML:t},e)}loadAdBreak(t,e){return null!=t&&t.adTag?this.loadAdTag(t.adTag,e):null!=t&&t.adXml?this.loadAdXml(t.adXml,e):void 0}buildAndLoadAdObj(t,e){const n={_position:st(this.player),adBreakId:this.player.utils.genId(12)},r=Object.assign(n,t);this.loadAdObj(r,e)}loadAdObj(t,e){const n=this.player.utils.extend({},this.pluginConfig),r=new(null!=e&&e.Options?e.Options:qt)(n,this.player.getConfig(),this.player.utils),i=this.playlistItemManager?this.playlistItemManager.blockingInstreamPlayer:null;i&&(i.noResume=!0),this.reset(),this.playlistItemManager=this.createPlaylistItemManager({item:this.player.getPlaylistItem()},A,r),this.playlistItemManager&&!this.playlistItemManager.destroyed()&&(this.playlistItemManager.startAdBreak(t),this.playlistItemManager.triggerAdBreakEvents(t))}handleDependencyError(t,e){this.destroy(),this.player.trigger(f,Jt(null,{message:t,adErrorCode:e,id:_,placement:K(this.playerConfig),tag:""}))}onReady(t){if(this.videoElement||(this.videoElement=this.player.createInstream().getMediaElement()),null!=t&&t.sdkPromise?t.sdkPromise():Ht(this.player.utils).catch(t=>{t.message.match(/Failed to load/)&&this.handleDependencyError("Ad playback blocked by an ad blocker",2e4)}),"idle"!==this.player.getState())return;const e=document.body;this.primeAdDisplay=()=>{e.removeEventListener("mouseup",this.primeAdDisplay),e.removeEventListener("touchend",this.primeAdDisplay),this.adsLoader.initializeDisplay(),this.primeAdDisplay=null},e.addEventListener("mouseup",this.primeAdDisplay,!1),e.addEventListener("touchend",this.primeAdDisplay,!1)}onPlaylistItemCallback(t){this.playlistItemEventCount++;const e=Object.assign({playlistItemEventCount:this.playlistItemEventCount},this.options);this.handlePlaylistItem(t,b,e),this.playlistItemManager&&!this.playlistItemManager.schedule.isVMAP()&&this.sendCues(this.playlistItemManager.schedule,this.options.cuetext)}onPlaylistCompleteCallback(){this.resetSchedule(!0)}onCastCallback(t){this.casting=Boolean(t.active),t.active&&this.resetSchedule()}onMuteCallback(t){this.instreamProvider.mute(t)}onDestroyPlugin(){this.reset()}onDestroyBidding(){this.bidsBlock=null}reset(t){this.playlistItemManager&&(t&&(this.nextPlaylistItemManager=this.playlistItemManager.next,this.nextPlaylistRelated=this.playlistItemManager.nextPlaylistRelated),this.playlistItemManager.off(null,null,this),this.playlistItemManager.destroy(),this.playlistItemManager=null),this.primeAdDisplay&&(document.body.removeEventListener("mouseup",this.primeAdDisplay),document.body.removeEventListener("touchend",this.primeAdDisplay)),this.configScheduleParser.reset()}destroy(){var t;this.reset(),null==this||null==(t=this.adsLoader)||t.destroy(),this.resetCues(),this.player.off(null,null,this),this.player.playAd=this.player.utils.noop,this.player.loadAdTag=this.player.utils.noop,this.player.loadAdXml=this.player.utils.noop,this.player.pauseAd=this.player.utils.noop}})}();
